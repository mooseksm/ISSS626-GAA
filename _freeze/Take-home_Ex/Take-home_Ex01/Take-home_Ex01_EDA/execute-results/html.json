{
  "hash": "9aea045c1c399911984e7dc29fb5ac6d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1 (Additional EDA)\"\nauthor: \"Kock Si Min\"\ndate: September 2, 2024\ndate-modified: \"last-modified\"\ntoc: true\nexecute:\n  eval: true\n  echo: true\n  freeze: true\n  warning: false\n  message: false\n---\n\n\n# Take-Home Exercise 1: **Geospatial Analytics for Public Good (Additional Exploratory Data Analysis)**\n\n::: {.callout-note collapse=\"true\" icon=\"false\"}\n# Increasing timeout to mitigate error issues during rendering\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(timeout = 3000)\n```\n:::\n\n\n### Loading necessary R packages for analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf,spatstat,raster,maptools,tmap,tidyverse,spNetwork,DT,forcats,ggthemes,plotly)\n```\n:::\n\n\n### Loading the *roadacc* data file\n\n\n::: {.cell}\n\n```{.r .cell-code}\nroadacc <- read_rds(\"data/rds/roadacc.rds\")\n```\n:::\n\n:::\n\n## 6. Exploratory Data Analysis (EDA)\n\nWe carry some EDA to understand how the occurrences of road accidents could be influenced by different factors.\n\n### 6.1 Distribution of Road Accidents across Provinces\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(province_en, province_en, .fun = length))) + \n  geom_bar(fill = \"skyblue\") +\n  labs(title = \"Distribution of Road Accidents across Provinces\", x = \"Province\", y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nAs noted from the plot, Bangkok has the highest occurrences of road accidents in the BMR, followed by Samut Prakan, Pathum Thani, Samut Sakhon, Nakhon Pathom and Nonthaburi.\n\n### 6.2 Distribution of Road Accidents by agency\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(agency, agency, .fun = length))) + \n  geom_bar(fill = \"lightgreen\") +\n  labs(title = \"Distribution of Road Accidents by Agency\", x = \"Agency\", y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nAs noted from the plot, the Department of Highways is responsible for the most occurrences of road accidents in the BMR, followed by Department of Rural Roads and Expressway Authority of Thailand.\n\n### 6.3 Distribution of Road Accidents by time\n\nWe also analyse the road accidents by time, namely by year, by month, by day of week and by time of day.\n\n### 6.3.1 By year\n\n::: panel-tabset\n## By year\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = inc_year)) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Year\", x = \"Year\", y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nWe note from the plot that the number of road accidents has generally been increasing from 2019 to 2022.\n\n## By year (at province level)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = inc_year)) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Year\", x = \"Year\", y = \"Count\") +\n  facet_wrap(~province_en)+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n-   We note from above that the number of road accidents has generally been increasing in Bangkok and Samut Prakan from 2019 to 2022.\n\n    -   This is with the exception of a drop in 2021 in Bangkok - this could potentially be due to the [surge of COVID-19 cases in Thailand in 2021 which led to a lockdown](https://www.sciencedirect.com/science/article/pii/S2468042723000350) which meant that there were less tourists, vehicles and pedestrians on the roads, and lower occurrences of road accidents.\n\n-   We note that the number of road accidents in Nonthaburi and Pathum Thani increased from 2019 to 2021 and fell in 2022.\n\n-   We note that the number of road accidents in Samut Sakhon fell from 2019 to 2021 but increased in 2022.\n\n-   Of the 6 provinces, we note that only Nakhon Pathom experienced a fall in road accidents from 2019 to 2022.\n:::\n\n### 6.3.2 By month\n\nWe also observe the data by month using cycle plots that would enable us to observe cyclical/seasonal patterns, if present.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nroadacc_month <- roadacc %>%\n  group_by(inc_year,inc_month) %>%\n  summarise(count = n(), .groups = 'drop')\n```\n:::\n\n\nWe save *roadacc_month* as a rds file:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(roadacc_month,\"data/rds/roadacc_month.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroadacc_month <- read_rds(\"data/rds/roadacc_month.rds\")\n```\n:::\n\n\n### 6.3.2.1 Plotting distribution of road accidents by month across the years\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhline.data <- roadacc_month %>%\n  group_by(inc_month) %>%\n  summarise(avgvalue = mean(count))\n\nggplot(data = roadacc_month, aes(x = inc_year, y = count)) +\n  geom_line(aes(group = inc_month, colour = as.factor(inc_month))) +\n  geom_hline(aes(yintercept=avgvalue),\n             data=hline.data,\n             linetype=6,\n             colour=\"red\",\n             size=0.5)+\n  facet_wrap(~inc_month,scales = \"free_x\")+\n  labs(title = \"Road accidents by month from 2019 to 2022\",\n                   colour = \"Month\") +\n  xlab(\"Year\")+\n  ylab(\"Number of Road Accidents\")+\n  scale_color_brewer(palette = \"Paired\") + \n  theme(axis.text.x = element_text(angle = 90),\n        legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nBased on the plot, we observe the following:\n\n-   **Occurrences of road accidents in Jan and Feb seem to generally be decreasing over the years**, with the number of road accidents in 2022 for both months falling below the average number of road accidents for the month across 2019 to 2022.\n\n-   **Occurrences of road accidents in Jul, Aug, Oct to Dec seem to generally be increasing over the years.** Based on this observation alone, the increase in road accidents could potentially be due to the rainy season between Jul to Oct and the presence of a higher population due to peak tourist seasons in Nov and Dec.\n\n-   **Occurrences of road accidents in Mar to Jun and Sep generally do not fluctuate much over the years.**\n\n### 6.3.2.2 Plotting distribution of road accidents by month by province\n\nWe further observe the occurrence of road accidents by month at the province level:\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nroadacc_month_bkk <- roadacc %>%\n  filter(province_en==\"Bangkok\") %>%\n  group_by(inc_year,inc_month) %>%\n  summarise(count = n(), .groups = 'drop')\n\nroadacc_month_sp <- roadacc %>%\n  filter(province_en==\"Samut Prakan\") %>%\n  group_by(inc_year,inc_month) %>%\n  summarise(count = n(), .groups = 'drop')\n\nroadacc_month_n <- roadacc %>%\n  filter(province_en==\"Nonthaburi\") %>%\n  group_by(inc_year,inc_month) %>%\n  summarise(count = n(), .groups = 'drop')\n\nroadacc_month_pt <- roadacc %>%\n  filter(province_en==\"Pathum Thani\") %>%\n  group_by(inc_year,inc_month) %>%\n  summarise(count = n(), .groups = 'drop')\n\nroadacc_month_np <- roadacc %>%\n  filter(province_en==\"Nakhon Pathom\") %>%\n  group_by(inc_year,inc_month) %>%\n  summarise(count = n(), .groups = 'drop')\n\nroadacc_month_ss <- roadacc %>%\n  filter(province_en==\"Samut Sakhon\") %>%\n  group_by(inc_year,inc_month) %>%\n  summarise(count = n(), .groups = 'drop')\n```\n:::\n\n\nSaving them as rds files:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(roadacc_month_bkk,\"data/rds/roadacc_month_bkk.rds\")\nwrite_rds(roadacc_month_sp,\"data/rds/roadacc_month_sp.rds\")\nwrite_rds(roadacc_month_n,\"data/rds/roadacc_month_n.rds\")\nwrite_rds(roadacc_month_pt,\"data/rds/roadacc_month_pt.rds\")\nwrite_rds(roadacc_month_np,\"data/rds/roadacc_month_np.rds\")\nwrite_rds(roadacc_month_ss,\"data/rds/roadacc_month_ss.rds\")\n```\n:::\n\n\nLoading the newly created rds files into R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nroadacc_month_bkk <- read_rds(\"data/rds/roadacc_month_bkk.rds\")\nroadacc_month_sp <- read_rds(\"data/rds/roadacc_month_sp.rds\")\nroadacc_month_n <- read_rds(\"data/rds/roadacc_month_n.rds\")\nroadacc_month_pt <- read_rds(\"data/rds/roadacc_month_pt.rds\")\nroadacc_month_np <- read_rds(\"data/rds/roadacc_month_np.rds\")\nroadacc_month_ss <- read_rds(\"data/rds/roadacc_month_ss.rds\")\n```\n:::\n\n:::\n\n::: panel-tabset\n## Bangkok\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhline.data <- roadacc_month_bkk %>%\n  group_by(inc_month) %>%\n  summarise(avgvalue = mean(count))\n\nggplot(data = roadacc_month_bkk, aes(x = inc_year, y = count)) +\n  geom_line(aes(group = inc_month, colour = as.factor(inc_month))) +\n  geom_hline(aes(yintercept=avgvalue),\n             data=hline.data,\n             linetype=6,\n             colour=\"red\",\n             size=0.5)+\n  facet_wrap(~inc_month,scales = \"free_x\")+\n  labs(title = \"Bangkok Road accidents by month from 2019 to 2022\",\n                   colour = \"Month\") +\n  xlab(\"Year\")+\n  ylab(\"Number of Road Accidents\")+\n  scale_color_brewer(palette = \"Paired\") + \n  theme(axis.text.x = element_text(angle = 90),\n        legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nThe following observations were made:\n\n-   **Occurrences of road accidents in Jan seem to be fluctuating,** with the number of road accidents decreasing from 2019 to 2021 then increasing in 2022.\n\n-   **Occurrences of road accidents in Feb seem to generally be decreasing over the years**, with the number of road accidents in 2022 falling below the average number of road accidents for the month across 2019 to 2022.\n\n-   **Occurrences of road accidents in Jul to Dec seem to generally be increasing over the years.** Based on this observation alone, the increase in road accidents could potentially be due to the rainy season between Jul to Oct and the presence of a higher population due to peak tourist seasons in Nov and Dec.\n\n-   **Occurrences of road accidents in Mar to Jun generally do not fluctuate much over the years.**\n\n## Samut Prakan\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhline.data <- roadacc_month_sp %>%\n  group_by(inc_month) %>%\n  summarise(avgvalue = mean(count))\n\nggplot(data = roadacc_month_sp, aes(x = inc_year, y = count)) +\n  geom_line(aes(group = inc_month, colour = as.factor(inc_month))) +\n  geom_hline(aes(yintercept=avgvalue),\n             data=hline.data,\n             linetype=6,\n             colour=\"red\",\n             size=0.5)+\n  facet_wrap(~inc_month,scales = \"free_x\")+\n  labs(title = \"Samut Prakan Road accidents by month from 2019 to 2022\",\n                   colour = \"Month\") +\n  xlab(\"Year\")+\n  ylab(\"Number of Road Accidents\")+\n  scale_color_brewer(palette = \"Paired\") + \n  theme(axis.text.x = element_text(angle = 90),\n        legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nThe following observations were made:\n\n-   **Occurrences of road accidents in Jan seem to generally be decreasing over the years**, with the number of road accidents in 2022 falling below the average number of road accidents for the month across 2019 to 2022.\n\n-   **Occurrences of road accidents in Apr to Aug and Nov to Dec seem to generally be increasing over the years.** Based on this observation alone, the increase in road accidents could potentially be due to the hotter and rainier seasons in Apr to Aug and the presence of a higher population due to peak tourist seasons in May, Jun, Nov and Dec.\n\n-   **Occurrences of road accidents in Feb to Mar and Sep to Oct increased initially then fell towards 2022.**\n\n## Nonthaburi\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhline.data <- roadacc_month_n %>%\n  group_by(inc_month) %>%\n  summarise(avgvalue = mean(count))\n\nggplot(data = roadacc_month_n, aes(x = inc_year, y = count)) +\n  geom_line(aes(group = inc_month, colour = as.factor(inc_month))) +\n  geom_hline(aes(yintercept=avgvalue),\n             data=hline.data,\n             linetype=6,\n             colour=\"red\",\n             size=0.5)+\n  facet_wrap(~inc_month,scales = \"free_x\")+\n  labs(title = \"Nonthaburi Road accidents by month from 2019 to 2022\",\n                   colour = \"Month\") +\n  xlab(\"Year\")+\n  ylab(\"Number of Road Accidents\")+\n  scale_color_brewer(palette = \"Paired\") + \n  theme(axis.text.x = element_text(angle = 90),\n        legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\nThe following observations were made:\n\n-   **Occurrences of road accidents in Feb seem to generally be decreasing over the years.**\n\n-   **Occurrences of road accidents in Jan seem to generally be increasing over the years.**\n\n-   **Occurrences of road accidents in Jul, Aug, Nov and Dec increased initially then fell towards 2022.**\n\n-   **Occurrences of road accidents in Mar to Jun, Sep and Oct seem to fluctuate generally around the monthly average across the years.**\n\n-   **As compared to Bangkok, Samut Prakan and Pathum Thani, the number of road accidents in Nonthaburi seem to be lesser, indicating that roads are more well managed in Nonthaburi.**\n\n## Pathum Thani\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhline.data <- roadacc_month_pt %>%\n  group_by(inc_month) %>%\n  summarise(avgvalue = mean(count))\n\nggplot(data = roadacc_month_pt, aes(x = inc_year, y = count)) +\n  geom_line(aes(group = inc_month, colour = as.factor(inc_month))) +\n  geom_hline(aes(yintercept=avgvalue),\n             data=hline.data,\n             linetype=6,\n             colour=\"red\",\n             size=0.5)+\n  facet_wrap(~inc_month,scales = \"free_x\")+\n  labs(title = \"Pathum Thani Road accidents by month from 2019 to 2022\",\n                   colour = \"Month\") +\n  xlab(\"Year\")+\n  ylab(\"Number of Road Accidents\")+\n  scale_color_brewer(palette = \"Paired\") + \n  theme(axis.text.x = element_text(angle = 90),\n        legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\nThe following observations were made:\n\n-   **Occurrences of road accidents in Jun to Aug and Oct seem to generally be increasing over the years.** This could be explained by the rainier seasons in Thailand during this period.\n-   **Occurrences of road accidents in Mar, Apr, May and Nov increased initially then fell towards 2022.**\n-   **Occurrences of road accidents in Jan, Feb, Sep and Dec seem to fluctuate generally around the monthly average across the years.**\n\n## Nakhon Pathom\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhline.data <- roadacc_month_np %>%\n  group_by(inc_month) %>%\n  summarise(avgvalue = mean(count))\n\nggplot(data = roadacc_month_np, aes(x = inc_year, y = count)) +\n  geom_line(aes(group = inc_month, colour = as.factor(inc_month))) +\n  geom_hline(aes(yintercept=avgvalue),\n             data=hline.data,\n             linetype=6,\n             colour=\"red\",\n             size=0.5)+\n  facet_wrap(~inc_month,scales = \"free_x\")+\n  labs(title = \"Nakhon Pathom Road accidents by month from 2019 to 2022\",\n                   colour = \"Month\") +\n  xlab(\"Year\")+\n  ylab(\"Number of Road Accidents\")+\n  scale_color_brewer(palette = \"Paired\") + \n  theme(axis.text.x = element_text(angle = 90),\n        legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nThe following observations were made:\n\n-   **Occurrences of road accidents in Jan to Mar, May, Jul to Dec seem to generally be decreasing over the years.**\n-   **Occurrences of road accidents in Apr and Jun seem to be fluctuating around the monthly average across the years.**\n-   **Based on these observations, it seems like road accidents are much lesser in Nakhon Pathom as compared to the other provinces and it is the only province with no obvious increase in occurrences of road accidents across the years, this indicates that the province is more well managed as compared to the other 5 provinces.**\n\n## Samut Sakhon\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhline.data <- roadacc_month_ss %>%\n  group_by(inc_month) %>%\n  summarise(avgvalue = mean(count))\n\nggplot(data = roadacc_month_ss, aes(x = inc_year, y = count)) +\n  geom_line(aes(group = inc_month, colour = as.factor(inc_month))) +\n  geom_hline(aes(yintercept=avgvalue),\n             data=hline.data,\n             linetype=6,\n             colour=\"red\",\n             size=0.5)+\n  facet_wrap(~inc_month,scales = \"free_x\")+\n  labs(title = \"Samut Sakhon Road accidents by month from 2019 to 2022\",\n                   colour = \"Month\") +\n  xlab(\"Year\")+\n  ylab(\"Number of Road Accidents\")+\n  scale_color_brewer(palette = \"Paired\") + \n  theme(axis.text.x = element_text(angle = 90),\n        legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nThe following observations were made:\n\n-   **Occurrences of road accidents in Jan, Feb, Apr and Jun seem to generally be decreasing over the years.**\n-   **Occurrences of road accidents in Jul to Dec seem to be increasing over the years.** Based on this observation alone, the increase in road accidents could potentially be due to the hotter and rainier seasons in Jul to Oct and the presence of a higher population due to peak tourist seasons in Nov and Dec.\n-   **Occurrences of road accidents in Mar and May seem to fluctuate generally around the monthly average across the years.**\n:::\n\n### 6.3.3 By day of week\n\n::: panel-tabset\n## Overall\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = inc_dayofweek)) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Day of Week\", x = \"Day of Week\", y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\nWe note from the plot that road accidents occur mostly on Fri and Sat and this could be explained by these days being the start of the weekend, and more people and vehicles may be out on the roads and in public places, which increase the chances of road accidents occuring.\n\n## Breakdown by province\n\n\n::: {.cell}\n\n```{.r .cell-code}\np0 <- ggplot(roadacc, aes(x = inc_dayofweek)) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Day of Week\", x = \"Day of Week\", y = \"Count\") +\n  facet_wrap(~province_en, scales = \"fixed\")\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of 1\n $ axis.text.x:List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : num 8\n  ..$ hjust        : num 1\n  ..$ vjust        : NULL\n  ..$ angle        : num 90\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi FALSE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n - attr(*, \"class\")= chr [1:2] \"theme\" \"gg\"\n - attr(*, \"complete\")= logi FALSE\n - attr(*, \"validate\")= logi TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nggplotly(p0)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-496c8cfc49a4bddaf1fa\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-496c8cfc49a4bddaf1fa\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7],\"y\":[856,836,840,776,1000,990,790],\"text\":[\"count:  856<br />inc_dayofweek: Mon\",\"count:  836<br />inc_dayofweek: Tue\",\"count:  840<br />inc_dayofweek: Wed\",\"count:  776<br />inc_dayofweek: Thu\",\"count: 1000<br />inc_dayofweek: Fri\",\"count:  990<br />inc_dayofweek: Sat\",\"count:  790<br />inc_dayofweek: Sun\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7],\"y\":[138,129,99,121,116,148,140],\"text\":[\"count:  138<br />inc_dayofweek: Mon\",\"count:  129<br />inc_dayofweek: Tue\",\"count:   99<br />inc_dayofweek: Wed\",\"count:  121<br />inc_dayofweek: Thu\",\"count:  116<br />inc_dayofweek: Fri\",\"count:  148<br />inc_dayofweek: Sat\",\"count:  140<br />inc_dayofweek: Sun\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7],\"y\":[113,108,104,122,127,123,130],\"text\":[\"count:  113<br />inc_dayofweek: Mon\",\"count:  108<br />inc_dayofweek: Tue\",\"count:  104<br />inc_dayofweek: Wed\",\"count:  122<br />inc_dayofweek: Thu\",\"count:  127<br />inc_dayofweek: Fri\",\"count:  123<br />inc_dayofweek: Sat\",\"count:  130<br />inc_dayofweek: Sun\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7],\"y\":[274,246,261,274,292,303,273],\"text\":[\"count:  274<br />inc_dayofweek: Mon\",\"count:  246<br />inc_dayofweek: Tue\",\"count:  261<br />inc_dayofweek: Wed\",\"count:  274<br />inc_dayofweek: Thu\",\"count:  292<br />inc_dayofweek: Fri\",\"count:  303<br />inc_dayofweek: Sat\",\"count:  273<br />inc_dayofweek: Sun\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7],\"y\":[274,332,295,313,376,331,320],\"text\":[\"count:  274<br />inc_dayofweek: Mon\",\"count:  332<br />inc_dayofweek: Tue\",\"count:  295<br />inc_dayofweek: Wed\",\"count:  313<br />inc_dayofweek: Thu\",\"count:  376<br />inc_dayofweek: Fri\",\"count:  331<br />inc_dayofweek: Sat\",\"count:  320<br />inc_dayofweek: Sun\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7],\"y\":[158,123,146,147,150,157,134],\"text\":[\"count:  158<br />inc_dayofweek: Mon\",\"count:  123<br />inc_dayofweek: Tue\",\"count:  146<br />inc_dayofweek: Wed\",\"count:  147<br />inc_dayofweek: Thu\",\"count:  150<br />inc_dayofweek: Fri\",\"count:  157<br />inc_dayofweek: Sat\",\"count:  134<br />inc_dayofweek: Sun\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":55.452054794520549,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":48.949771689497723},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Distribution of Road Accidents by Day of Week\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,0.32925636007827785],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,7.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"],\"tickvals\":[1,2,3,4.0000000000000009,5,6,7],\"categoryorder\":\"array\",\"categoryarray\":[\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"annotations\":[{\"text\":\"Day of Week\",\"x\":0.5,\"y\":0,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"top\",\"annotationType\":\"axis\",\"yshift\":-21.917808219178088},{\"text\":\"Count\",\"x\":0,\"y\":0.5,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-90,\"xanchor\":\"right\",\"yanchor\":\"center\",\"annotationType\":\"axis\",\"xshift\":-33.607305936073068},{\"text\":\"Bangkok\",\"x\":0.16462818003913893,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Nakhon Pathom\",\"x\":0.5,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Nonthaburi\",\"x\":0.83537181996086107,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Pathum Thani\",\"x\":0.16462818003913893,\"y\":0.48515981735159819,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Samut Prakan\",\"x\":0.5,\"y\":0.48515981735159819,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Samut Sakhon\",\"x\":0.83537181996086107,\"y\":0.48515981735159819,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"}],\"yaxis\":{\"domain\":[0.51484018264840181,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-50,1050],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"250\",\"500\",\"750\",\"1000\"],\"tickvals\":[0,250,500,750,1000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"250\",\"500\",\"750\",\"1000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32925636007827785,\"y0\":0.51484018264840181,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32925636007827785,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.33741030658838878,\"x1\":0.66258969341161122,\"y0\":0.51484018264840181,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.33741030658838878,\"x1\":0.66258969341161122,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67074363992172203,\"x1\":1,\"y0\":0.51484018264840181,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67074363992172203,\"x1\":1,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32925636007827785,\"y0\":0,\"y1\":0.48515981735159819},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32925636007827785,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":0.48515981735159819,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.33741030658838878,\"x1\":0.66258969341161122,\"y0\":0,\"y1\":0.48515981735159819},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.33741030658838878,\"x1\":0.66258969341161122,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":0.48515981735159819,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67074363992172203,\"x1\":1,\"y0\":0,\"y1\":0.48515981735159819},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67074363992172203,\"x1\":1,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":0.48515981735159819,\"ysizemode\":\"pixel\"}],\"xaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,7.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"],\"tickvals\":[1,2,3,4.0000000000000009,5,6,7],\"categoryorder\":\"array\",\"categoryarray\":[\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0.33741030658838878,0.66258969341161122],\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"xaxis3\":{\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,7.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"],\"tickvals\":[1,2,3,4.0000000000000009,5,6,7],\"categoryorder\":\"array\",\"categoryarray\":[\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0.67074363992172203,1],\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"yaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[-50,1050],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"250\",\"500\",\"750\",\"1000\"],\"tickvals\":[0,250,500,750,1000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"250\",\"500\",\"750\",\"1000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0,0.48515981735159819],\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"7a149857b38\":{\"x\":{},\"type\":\"bar\"}},\"cur_data\":\"7a149857b38\",\"visdat\":{\"7a149857b38\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n**Across the provinces, it is obvious that road accidents occur most often on Fri and Sat in Bangkok. However, for the other provinces, the difference is not so obvious and it seems like the occurrences of road accidents are more well spread out across the week.** This could be explained by Bangkok being a prime tourist destination and major urban centre, and it could attract a greater crowd from within and outside of Thailand over the weekend, hence leading to greater traffic on the road and higher chances of road accidents occurring.\n:::\n\n### 6.3.4 By time of day\n\n::: panel-tabset\n## Overall\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = inc_time)) + \n  geom_histogram(binwidth = 1, fill = \"slategrey\", color = \"black\") +\n  scale_x_continuous(breaks = seq(0, 23, 1))+\n  labs(title = \"Distribution of Road Accidents by Time of Day\", \n       x = \"Time of Day\",\n       y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n**Based on the chart, it is observed that road accidents occur more often between 7am to 11pm as compared to 12 midnight to 6am.** This could be explained by 7am to 11pm being the time when most are awake for their daily activities and the roads are likely to have higher activity, which result in higher chances of occurrences of road accidents. **The top two timings at which road accidents occur are at 9am and 7pm** and this could be explained by it being the peak hour at which the general population i.e. workers, school students get to and get off work and school.\n\n## Breakdown by province\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(roadacc, aes(x = inc_time)) + \n  geom_histogram(binwidth = 1, fill = \"slategrey\", color = \"black\") +\n  scale_x_continuous(breaks = seq(0, 23, 1))+\n  labs(title = \"Distribution of Road Accidents by Time of Day\", \n       x = \"Time of Day\",\n       y = \"Count\") +\n  facet_wrap(~province_en, scales = \"fixed\")+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n\nggplotly(p1)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-6e3e838200f7f1a6eb73\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-6e3e838200f7f1a6eb73\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],\"y\":[187,157,137,139,156,206,187,271,327,353,316,339,257,269,284,279,321,279,306,338,265,272,229,214],\"text\":[\"count: 187<br />inc_time:  0\",\"count: 157<br />inc_time:  1\",\"count: 137<br />inc_time:  2\",\"count: 139<br />inc_time:  3\",\"count: 156<br />inc_time:  4\",\"count: 206<br />inc_time:  5\",\"count: 187<br />inc_time:  6\",\"count: 271<br />inc_time:  7\",\"count: 327<br />inc_time:  8\",\"count: 353<br />inc_time:  9\",\"count: 316<br />inc_time: 10\",\"count: 339<br />inc_time: 11\",\"count: 257<br />inc_time: 12\",\"count: 269<br />inc_time: 13\",\"count: 284<br />inc_time: 14\",\"count: 279<br />inc_time: 15\",\"count: 321<br />inc_time: 16\",\"count: 279<br />inc_time: 17\",\"count: 306<br />inc_time: 18\",\"count: 338<br />inc_time: 19\",\"count: 265<br />inc_time: 20\",\"count: 272<br />inc_time: 21\",\"count: 229<br />inc_time: 22\",\"count: 214<br />inc_time: 23\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],\"y\":[38,42,40,27,30,30,31,47,30,44,31,33,30,37,47,53,40,37,24,41,39,53,35,32],\"text\":[\"count:  38<br />inc_time:  0\",\"count:  42<br />inc_time:  1\",\"count:  40<br />inc_time:  2\",\"count:  27<br />inc_time:  3\",\"count:  30<br />inc_time:  4\",\"count:  30<br />inc_time:  5\",\"count:  31<br />inc_time:  6\",\"count:  47<br />inc_time:  7\",\"count:  30<br />inc_time:  8\",\"count:  44<br />inc_time:  9\",\"count:  31<br />inc_time: 10\",\"count:  33<br />inc_time: 11\",\"count:  30<br />inc_time: 12\",\"count:  37<br />inc_time: 13\",\"count:  47<br />inc_time: 14\",\"count:  53<br />inc_time: 15\",\"count:  40<br />inc_time: 16\",\"count:  37<br />inc_time: 17\",\"count:  24<br />inc_time: 18\",\"count:  41<br />inc_time: 19\",\"count:  39<br />inc_time: 20\",\"count:  53<br />inc_time: 21\",\"count:  35<br />inc_time: 22\",\"count:  32<br />inc_time: 23\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"}},\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],\"y\":[35,46,37,29,29,27,26,34,31,41,49,34,23,30,31,48,33,27,29,35,45,37,34,37],\"text\":[\"count:  35<br />inc_time:  0\",\"count:  46<br />inc_time:  1\",\"count:  37<br />inc_time:  2\",\"count:  29<br />inc_time:  3\",\"count:  29<br />inc_time:  4\",\"count:  27<br />inc_time:  5\",\"count:  26<br />inc_time:  6\",\"count:  34<br />inc_time:  7\",\"count:  31<br />inc_time:  8\",\"count:  41<br />inc_time:  9\",\"count:  49<br />inc_time: 10\",\"count:  34<br />inc_time: 11\",\"count:  23<br />inc_time: 12\",\"count:  30<br />inc_time: 13\",\"count:  31<br />inc_time: 14\",\"count:  48<br />inc_time: 15\",\"count:  33<br />inc_time: 16\",\"count:  27<br />inc_time: 17\",\"count:  29<br />inc_time: 18\",\"count:  35<br />inc_time: 19\",\"count:  45<br />inc_time: 20\",\"count:  37<br />inc_time: 21\",\"count:  34<br />inc_time: 22\",\"count:  37<br />inc_time: 23\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"}},\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],\"y\":[66,58,56,56,74,70,67,83,86,90,100,90,82,98,95,86,78,78,71,101,90,77,85,86],\"text\":[\"count:  66<br />inc_time:  0\",\"count:  58<br />inc_time:  1\",\"count:  56<br />inc_time:  2\",\"count:  56<br />inc_time:  3\",\"count:  74<br />inc_time:  4\",\"count:  70<br />inc_time:  5\",\"count:  67<br />inc_time:  6\",\"count:  83<br />inc_time:  7\",\"count:  86<br />inc_time:  8\",\"count:  90<br />inc_time:  9\",\"count: 100<br />inc_time: 10\",\"count:  90<br />inc_time: 11\",\"count:  82<br />inc_time: 12\",\"count:  98<br />inc_time: 13\",\"count:  95<br />inc_time: 14\",\"count:  86<br />inc_time: 15\",\"count:  78<br />inc_time: 16\",\"count:  78<br />inc_time: 17\",\"count:  71<br />inc_time: 18\",\"count: 101<br />inc_time: 19\",\"count:  90<br />inc_time: 20\",\"count:  77<br />inc_time: 21\",\"count:  85<br />inc_time: 22\",\"count:  86<br />inc_time: 23\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],\"y\":[51,81,66,36,51,47,68,123,104,98,104,115,103,107,120,96,108,111,133,119,115,83,111,91],\"text\":[\"count:  51<br />inc_time:  0\",\"count:  81<br />inc_time:  1\",\"count:  66<br />inc_time:  2\",\"count:  36<br />inc_time:  3\",\"count:  51<br />inc_time:  4\",\"count:  47<br />inc_time:  5\",\"count:  68<br />inc_time:  6\",\"count: 123<br />inc_time:  7\",\"count: 104<br />inc_time:  8\",\"count:  98<br />inc_time:  9\",\"count: 104<br />inc_time: 10\",\"count: 115<br />inc_time: 11\",\"count: 103<br />inc_time: 12\",\"count: 107<br />inc_time: 13\",\"count: 120<br />inc_time: 14\",\"count:  96<br />inc_time: 15\",\"count: 108<br />inc_time: 16\",\"count: 111<br />inc_time: 17\",\"count: 133<br />inc_time: 18\",\"count: 119<br />inc_time: 19\",\"count: 115<br />inc_time: 20\",\"count:  83<br />inc_time: 21\",\"count: 111<br />inc_time: 22\",\"count:  91<br />inc_time: 23\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"}},\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],\"y\":[42,37,31,32,21,37,29,52,52,48,43,41,42,54,40,61,56,39,34,38,41,43,57,45],\"text\":[\"count:  42<br />inc_time:  0\",\"count:  37<br />inc_time:  1\",\"count:  31<br />inc_time:  2\",\"count:  32<br />inc_time:  3\",\"count:  21<br />inc_time:  4\",\"count:  37<br />inc_time:  5\",\"count:  29<br />inc_time:  6\",\"count:  52<br />inc_time:  7\",\"count:  52<br />inc_time:  8\",\"count:  48<br />inc_time:  9\",\"count:  43<br />inc_time: 10\",\"count:  41<br />inc_time: 11\",\"count:  42<br />inc_time: 12\",\"count:  54<br />inc_time: 13\",\"count:  40<br />inc_time: 14\",\"count:  61<br />inc_time: 15\",\"count:  56<br />inc_time: 16\",\"count:  39<br />inc_time: 17\",\"count:  34<br />inc_time: 18\",\"count:  38<br />inc_time: 19\",\"count:  41<br />inc_time: 20\",\"count:  43<br />inc_time: 21\",\"count:  57<br />inc_time: 22\",\"count:  45<br />inc_time: 23\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(112,128,144,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"}},\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":55.452054794520549,\"r\":7.3059360730593621,\"b\":39.119966791199673,\"l\":43.105022831050235},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Distribution of Road Accidents by Time of Day\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,0.32925636007827785],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.7000000000000002,24.699999999999999],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"],\"tickvals\":[0,1,2,3,4,4.9999999999999991,6,6.9999999999999991,7.9999999999999991,9,10,11,12,12.999999999999996,14,15,16,17,18,19,20,21,22,23],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-90,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"annotations\":[{\"text\":\"Time of Day\",\"x\":0.5,\"y\":0,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"top\",\"annotationType\":\"axis\",\"yshift\":-20.85512660855127},{\"text\":\"Count\",\"x\":0,\"y\":0.5,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-90,\"xanchor\":\"right\",\"yanchor\":\"center\",\"annotationType\":\"axis\",\"xshift\":-27.762557077625573},{\"text\":\"Bangkok\",\"x\":0.16462818003913893,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Nakhon Pathom\",\"x\":0.5,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Nonthaburi\",\"x\":0.83537181996086107,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Pathum Thani\",\"x\":0.16462818003913893,\"y\":0.48515981735159819,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Samut Prakan\",\"x\":0.5,\"y\":0.48515981735159819,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Samut Sakhon\",\"x\":0.83537181996086107,\"y\":0.48515981735159819,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"}],\"yaxis\":{\"domain\":[0.51484018264840181,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-17.650000000000002,370.64999999999998],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"100\",\"200\",\"300\"],\"tickvals\":[0,99.999999999999986,200,300],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"100\",\"200\",\"300\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32925636007827785,\"y0\":0.51484018264840181,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32925636007827785,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.33741030658838878,\"x1\":0.66258969341161122,\"y0\":0.51484018264840181,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.33741030658838878,\"x1\":0.66258969341161122,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67074363992172203,\"x1\":1,\"y0\":0.51484018264840181,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67074363992172203,\"x1\":1,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32925636007827785,\"y0\":0,\"y1\":0.48515981735159819},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32925636007827785,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":0.48515981735159819,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.33741030658838878,\"x1\":0.66258969341161122,\"y0\":0,\"y1\":0.48515981735159819},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.33741030658838878,\"x1\":0.66258969341161122,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":0.48515981735159819,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67074363992172203,\"x1\":1,\"y0\":0,\"y1\":0.48515981735159819},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67074363992172203,\"x1\":1,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":0.48515981735159819,\"ysizemode\":\"pixel\"}],\"xaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[-1.7000000000000002,24.699999999999999],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"],\"tickvals\":[0,1,2,3,4,4.9999999999999991,6,6.9999999999999991,7.9999999999999991,9,10,11,12,12.999999999999996,14,15,16,17,18,19,20,21,22,23],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-90,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0.33741030658838878,0.66258969341161122],\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"xaxis3\":{\"type\":\"linear\",\"autorange\":false,\"range\":[-1.7000000000000002,24.699999999999999],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"],\"tickvals\":[0,1,2,3,4,4.9999999999999991,6,6.9999999999999991,7.9999999999999991,9,10,11,12,12.999999999999996,14,15,16,17,18,19,20,21,22,23],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-90,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0.67074363992172203,1],\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"yaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[-17.650000000000002,370.64999999999998],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"100\",\"200\",\"300\"],\"tickvals\":[0,99.999999999999986,200,300],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"100\",\"200\",\"300\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0,0.48515981735159819],\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"7a142c5f31b1\":{\"x\":{},\"type\":\"bar\"}},\"cur_data\":\"7a142c5f31b1\",\"visdat\":{\"7a142c5f31b1\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nBangkok, Samut Prakan and Pathum Thani also seem to follow the general observation seen under the overall chart for occurrences of road accidents by time day i.e. road accidents generally occur more during 7am to 11pm and peak timings are during the going to and getting off work/school hours at around 9am and 7pm. This is less obvious for the other provinces.\n:::\n\n### 6.4 Distribution of Road Accidents by weather condition\n\n::: panel-tabset\n## Overall\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(weather_condition, weather_condition, .fun = length))) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Weather Condition\", x = \"Weather Condition\", y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\nBased on the plot, road accidents mostly occur in clear weather conditions, followed by rainy weather conditions and dark weather conditions. This could imply that road accidents are more heavily influenced by other behavioural or environmental factors besides the weather condition.\n\n## Breakdown by Province\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(weather_condition, weather_condition, .fun = length))) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Weather Condition\", x = \"Weather Condition\", y = \"Count\") +\n  facet_wrap(~province_en)+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\nAcross provinces, similar observations were made as it was observed that road accidents mostly occur during clear weather conditions, followed by rainy and then dark weather conditions.\n:::\n\n### 6.5 Distribution of Road Accidents by road description\n\n::: panel-tabset\n## Overall\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(road_description, road_description, .fun = length))) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Road Description\", x = \"Road Description\", y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\nBased on the plot, road accidents mostly occur on straight roads, roads categorised as other, followed by wide curve and then grade-separated intersection/ramps. **Combining this observation with that for weather conditions - that road accidents mostly occur during clear weather conditions and straight roads - which are conditions under which one would not expect road accidents to occur, it could imply that the occurrence of road accidents are more heavily influenced by behavioural factors.**\n\n## Breakdown by Province\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(road_description, road_description, .fun = length))) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Road Description\", x = \"Road Description\", y = \"Count\") +\n  facet_wrap(~province_en)+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\nAcross provinces, similar observations were made as it was observed that road accidents mostly occur on straight roads, roads categorised as other, followed by wide curve and then grade-separated intersection/ramps.\n:::\n\n### 6.6 Distribution of Road Accidents by slope description\n\n::: panel-tabset\n## Overall\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(slope_description, slope_description, .fun = length))) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Slope Description\", x = \"Slope Description\", y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\nBased on the plot, road accidents where there are no slopes. **Combining this observation with the above observations - that road accidents mostly occur during clear weather conditions and on straight roads with no slope - which are conditions under which one would not expect road accidents to occur, it could imply that the occurrence of road accidents are more heavily influenced by behavioural factors.**\n\n## Breakdown by Province\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(slope_description, slope_description, .fun = length))) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Slope Description\", x = \"Slope Description\", y = \"Count\") +\n  facet_wrap(~province_en)+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\nAcross provinces, similar observations were made as it was observed that road accidents mostly occur on roads with no slope.\n:::\n\n### 6.7 Distribution of Road Accidents by vehicle type\n\n::: panel-tabset\n## Overall\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(vehicle_type, vehicle_type, .fun = length))) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Vehicle Type\", x = \"Vehicle Type\", y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\nBased on the plot, road accidents mostly involve private/passenger car, followed by 4-wheel pickup truck, motorcycle as the top 3 vehicles. These are small to mid-sized vehicles.\n\n## Breakdown by Province\n\nWe do a more detailed analysis at the province level:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(vehicle_type, vehicle_type, .fun = length))) +\n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Vehicle Type\", x = \"Vehicle Type\", y = \"Count\") +\n  facet_wrap(~province_en)+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n**Bangkok and Samut Prakan follow the same general observation seen under the overall chart for vehicle type involved in road accidents i.e. road accidents mostly involve private/passenger car, followed by 4-wheel pickup truck, motorcycle as the top 3 vehicles.** However the following were observed for the other provinces:\n\n-   **Road accidents in Nakhon Pathom, Pathum Thani and Samut Sakhon mostly involved 4-wheel pickup truck**\n\n-   **4-wheel pickup truck is not one of the top 3 vehicles involved in road accidents in Nonthaburi**\n:::\n\n### 6.8 Distribution of Road Accidents by presumed cause\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(presumed_cause, presumed_cause, .fun = length))) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Presumed Cause\", x = \"Presumed Cause\", y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\nThe top presumed cause for accident is speeding.\n\n### 6.9 Distribution of Road Accidents by accident type\n\n::: panel-tabset\n## Overall\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(accident_type, accident_type, .fun = length))) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Accident Type\", x = \"Accident Type Cause\", y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\nThe top two presumed cause for road accidents are rear-end collision and rollover/fallen on straight road.\n\n## Breakdown by Province\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(roadacc, aes(x = fct_reorder(accident_type, accident_type, .fun = length))) + \n  geom_bar(fill = \"slategrey\") +\n  labs(title = \"Distribution of Road Accidents by Accident Type\", x = \"Accident Type Cause\", y = \"Count\") +\n  facet_wrap(~province_en)+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n**Bangkok, Pathum Thani and Samut Prakan follow the same general observation seen under the overall chart that the top two presumed cause for road accidents are rear-end collision followed by rollover/fallen on straight road. For Nakhon Pathom, Nonthaburi and Samut Sakhon, the top presumed cause is rollover/fallen on straight road followed by rear-end collision.**\n:::\n\n### 6.10 Distribution of number of vehicles involved\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary_stats <- roadacc %>%\n  group_by(province_en) %>%\n  summarise(\n    median_vehicles = median(number_of_vehicles_involved, na.rm = TRUE),\n    mean_vehicles = mean(number_of_vehicles_involved, na.rm = TRUE),\n    min_vehicles = min(number_of_vehicles_involved,na.rm = TRUE),\n    q25 = quantile(number_of_vehicles_involved, 0.25, na.rm = TRUE),\n    q75 = quantile(number_of_vehicles_involved, 0.75, na.rm = TRUE),\n    max_vehicles = max(number_of_vehicles_involved,na.rm = TRUE),\n    .groups = 'drop'\n  ) %>%\n  mutate(label = paste0(\"Min: \", round(min_vehicles,1),\n                        \"\\nq25: \", round(q25,1),\n                        \"\\nMedian: \", round(median_vehicles, 1), \n                        \"\\nMean: \", round(mean_vehicles, 1),\n                        \"\\nq75: \", round(q75,1),\n                        \"\\nMax vehicles: \", round(max_vehicles,1)\n                        ))\n\nggplot(roadacc,\n       aes(x=province_en,\n           y=number_of_vehicles_involved,\n           fill = province_en))+\n  geom_boxplot(width = .20,\n               outlier.shape = NA)+\n  geom_text(data = summary_stats, \n            aes(x = province_en, y = q75, label = label), \n            vjust = -0.5, \n            size = 3)+\n  ggtitle(\"Distribution of Road Accidents by Number of Vehicles Involved\") +\n  labs(title = \"Distribution of Road Accidents by Number of Vehicles Involved\", x = \"Number of Vehicles Involved\", y = \"Count\")+\n  theme(legend.position = \"none\") +\n  scale_fill_viridis_d()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n\n**Across the provinces, the median number of vehicles involved in road accidents are either one or two.** However, the maximum number of vehicles that had been involved in road accidents were 12 (Pathum Thani), 11 (Bangkok), 10 (Samut Prakan), 9 (Nonthaburi and Samut Sakhon) and 8 (Nakhon Pathom), indicating that while not common, there are large-scale incidents involving large number of vehicles.\n\n### 6.11 Distribution of number of fatalities\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary_stats <- roadacc %>%\n  group_by(province_en) %>%\n  summarise(\n    median_fatalities = median(number_of_fatalities, na.rm = TRUE),\n    mean_fatalities = mean(number_of_fatalities, na.rm = TRUE),\n    min_fatalities = min(number_of_fatalities,na.rm = TRUE),\n    q25 = quantile(number_of_fatalities, 0.25, na.rm = TRUE),\n    q75 = quantile(number_of_fatalities, 0.75, na.rm = TRUE),\n    max_fatalities = max(number_of_fatalities,na.rm = TRUE),\n    .groups = 'drop'\n  ) %>%\n  mutate(label = paste0(\"Min: \", round(min_fatalities,1),\n                        \"\\nq25: \", round(q25,1),\n                        \"\\nMedian: \", round(median_fatalities, 1), \n                        \"\\nMean: \", round(mean_fatalities, 1),\n                        \"\\nq75: \", round(q75,1),\n                        \"\\nMax fatalities: \", round(max_fatalities,1)\n                        ))\n\nggplot(roadacc,\n       aes(x=province_en,\n           y=number_of_fatalities,\n           fill = province_en))+\n  geom_boxplot(width = .20,\n               outlier.shape = NA)+\n  geom_text(data = summary_stats, \n            aes(x = province_en, y = q75, label = label), \n            vjust = -0.5, \n            size = 3)+\n  ggtitle(\"Distribution of Road Accidents by Number of Fatalities\") +\n  labs(title = \"Distribution of Road Accidents by Number of Fatalities\", x = \"Number of Fatalities\", y = \"Count\")+\n  theme(legend.position = \"none\") +\n  scale_fill_viridis_d()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\nAcross the provinces, the median number of fatalities is 0. However, while few, there are road accidents that occur with higher number of fatalities - the highest being 13 (Samut Prakan), followed by 6 (Pathum Thani), 3 (Bangkok, Nonthaburi) and 2 (Nakhon Pathom and Samut Sakhon).\n\n### 6.12 Distribution of number of injuries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary_stats <- roadacc %>%\n  group_by(province_en) %>%\n  summarise(\n    median_injuries = median(number_of_injuries, na.rm = TRUE),\n    mean_injuries = mean(number_of_injuries, na.rm = TRUE),\n    min_injuries = min(number_of_injuries,na.rm = TRUE),\n    q25 = quantile(number_of_injuries, 0.25, na.rm = TRUE),\n    q75 = quantile(number_of_injuries, 0.75, na.rm = TRUE),\n    max_injuries = max(number_of_injuries,na.rm = TRUE),\n    .groups = 'drop'\n  ) %>%\n  mutate(label = paste0(\"Min: \", round(min_injuries,1),\n                        \"\\nq25: \", round(q25,1),\n                        \"\\nMedian: \", round(median_injuries, 1), \n                        \"\\nMean: \", round(mean_injuries, 1),\n                        \"\\nq75: \", round(q75,1),\n                        \"\\nMax injuries: \", round(max_injuries,1)\n                        ))\n\nggplot(roadacc,\n       aes(x=province_en,\n           y=number_of_injuries,\n           fill = province_en))+\n  geom_boxplot(width = .20,\n               outlier.shape = NA)+\n  geom_text(data = summary_stats, \n            aes(x = province_en, y = q75, label = label), \n            vjust = -0.5, \n            size = 3)+\n  ggtitle(\"Distribution of Road Accidents by Number of Injuries\") +\n  labs(title = \"Distribution of Road Accidents by Number of Injuries\", x = \"Number of Injuries\", y = \"Count\")+\n  theme(legend.position = \"none\") +\n  scale_fill_viridis_d()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_EDA_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n\nAcross the provinces, the median number of injuries is 0. However, while few, there are road accidents that occur with higher number of injuries - the highest being 51 (Pathum Thani), followed by 31 (Bangkok), 30 (Nakhon Pathom), 28 (Samut Prakan), 14 (Samut Sakhon) and 11 (Nonthaburi).\n",
    "supporting": [
      "Take-home_Ex01_EDA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}