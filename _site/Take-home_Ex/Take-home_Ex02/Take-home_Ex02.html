<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kock Si Min">
<meta name="dcterms.date" content="2024-10-02">

<title>ISSS626-GAA - Take-home Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS626-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01A.html">
 <span class="dropdown-text">Hands-on Exercise 1A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01B.html">
 <span class="dropdown-text">Hands-on Exercise 1B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02A.html">
 <span class="dropdown-text">Hands-on Exercise 2A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02B.html">
 <span class="dropdown-text">Hands-on Exercise 2B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05A.html">
 <span class="dropdown-text">Hands-on Exercise 5A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05B.html">
 <span class="dropdown-text">Hands-on Exercise 5B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01A.html">
 <span class="dropdown-text">Take-Home Exercise 1A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01B.html">
 <span class="dropdown-text">Take-Home Exercise 1B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#take-home-exercise-2-discovering-impacts-of-covid-19-on-thailand-tourism-economy-at-the-province-level-using-spatial-and-spatio-temporal-statistics" id="toc-take-home-exercise-2-discovering-impacts-of-covid-19-on-thailand-tourism-economy-at-the-province-level-using-spatial-and-spatio-temporal-statistics" class="nav-link active" data-scroll-target="#take-home-exercise-2-discovering-impacts-of-covid-19-on-thailand-tourism-economy-at-the-province-level-using-spatial-and-spatio-temporal-statistics">Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics</a>
  <ul class="collapse">
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link" data-scroll-target="#setting-the-scene">1. Setting the Scene</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">2. Objectives</a></li>
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task">3. The Task</a></li>
  <li><a href="#installing-and-loading-the-necessary-r-packages" id="toc-installing-and-loading-the-necessary-r-packages" class="nav-link" data-scroll-target="#installing-and-loading-the-necessary-r-packages">4. Installing and Loading the necessary R packages</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">5. The Data</a>
  <ul class="collapse">
  <li><a href="#thailand-domestic-tourism-statistics" id="toc-thailand-domestic-tourism-statistics" class="nav-link" data-scroll-target="#thailand-domestic-tourism-statistics">5.1 Thailand Domestic Tourism Statistics</a></li>
  <li><a href="#importing-the-csv-file" id="toc-importing-the-csv-file" class="nav-link" data-scroll-target="#importing-the-csv-file">5.1.1 Importing the csv file</a></li>
  <li><a href="#cleaning-the-data" id="toc-cleaning-the-data" class="nav-link" data-scroll-target="#cleaning-the-data">5.1.2 Cleaning the data</a></li>
  <li><a href="#dropping-unwanted-variables" id="toc-dropping-unwanted-variables" class="nav-link" data-scroll-target="#dropping-unwanted-variables">5.1.2.1 Dropping unwanted variables</a></li>
  <li><a href="#determine-the-presence-of-missing-data" id="toc-determine-the-presence-of-missing-data" class="nav-link" data-scroll-target="#determine-the-presence-of-missing-data">5.1.2.2 Determine the presence of missing data</a></li>
  <li><a href="#creating-new-year-month-and-day-variables" id="toc-creating-new-year-month-and-day-variables" class="nav-link" data-scroll-target="#creating-new-year-month-and-day-variables">5.1.2.3 Creating new year, month and day variables</a></li>
  <li><a href="#determine-the-distribution-of-provinces-and-corresponding-regions" id="toc-determine-the-distribution-of-provinces-and-corresponding-regions" class="nav-link" data-scroll-target="#determine-the-distribution-of-provinces-and-corresponding-regions">5.1.2.4 Determine the distribution of provinces and corresponding regions</a></li>
  <li><a href="#correcting-the-erroneous-regions-of-provinces" id="toc-correcting-the-erroneous-regions-of-provinces" class="nav-link" data-scroll-target="#correcting-the-erroneous-regions-of-provinces">5.1.2.4.1 Correcting the erroneous regions of provinces</a></li>
  <li><a href="#determine-the-distribution-of-variables-and-corresponding-values" id="toc-determine-the-distribution-of-variables-and-corresponding-values" class="nav-link" data-scroll-target="#determine-the-distribution-of-variables-and-corresponding-values">5.1.2.5 Determine the distribution of variables and corresponding values</a></li>
  <li><a href="#pivot_wider-to-expand-variables-as-individual-columns" id="toc-pivot_wider-to-expand-variables-as-individual-columns" class="nav-link" data-scroll-target="#pivot_wider-to-expand-variables-as-individual-columns">5.1.2.5.1 pivot_wider() to expand variables as individual columns</a></li>
  <li><a href="#checking-the-revenue-figures" id="toc-checking-the-revenue-figures" class="nav-link" data-scroll-target="#checking-the-revenue-figures">5.1.2.5.2 Checking the revenue figures</a></li>
  <li><a href="#checking-the-tourist-numbers" id="toc-checking-the-tourist-numbers" class="nav-link" data-scroll-target="#checking-the-tourist-numbers">5.1.2.5.3 Checking the tourist numbers</a></li>
  <li><a href="#checking-the-distribution-of-values-of-each-variable" id="toc-checking-the-distribution-of-values-of-each-variable" class="nav-link" data-scroll-target="#checking-the-distribution-of-values-of-each-variable">5.1.2.5.4 Checking the distribution of values of each variable</a></li>
  <li><a href="#removing-data-with-negative-revenue_foreign-values" id="toc-removing-data-with-negative-revenue_foreign-values" class="nav-link" data-scroll-target="#removing-data-with-negative-revenue_foreign-values">5.1.2.5.5 Removing data with negative “revenue_foreign” values</a></li>
  <li><a href="#saving-as-a-new-rds-file" id="toc-saving-as-a-new-rds-file" class="nav-link" data-scroll-target="#saving-as-a-new-rds-file">5.1.2.6 Saving as a new rds file</a></li>
  <li><a href="#creating-a-data-frame-for-spatial-analysis" id="toc-creating-a-data-frame-for-spatial-analysis" class="nav-link" data-scroll-target="#creating-a-data-frame-for-spatial-analysis">5.1.3 Creating a data frame for spatial analysis</a></li>
  <li><a href="#saving-as-a-new-rds-file-1" id="toc-saving-as-a-new-rds-file-1" class="nav-link" data-scroll-target="#saving-as-a-new-rds-file-1">5.1.3.1 Saving as a new rds file</a></li>
  <li><a href="#creating-a-data-frame-for-temporal-analysis" id="toc-creating-a-data-frame-for-temporal-analysis" class="nav-link" data-scroll-target="#creating-a-data-frame-for-temporal-analysis">5.1.4 Creating a data frame for temporal analysis</a></li>
  <li><a href="#saving-as-a-new-rds-file-2" id="toc-saving-as-a-new-rds-file-2" class="nav-link" data-scroll-target="#saving-as-a-new-rds-file-2">5.1.3.1 Saving as a new rds file</a></li>
  <li><a href="#thailand-subnational-administrative-boundaries" id="toc-thailand-subnational-administrative-boundaries" class="nav-link" data-scroll-target="#thailand-subnational-administrative-boundaries">5.2 Thailand Subnational Administrative Boundaries</a></li>
  <li><a href="#importing-the-shapefile" id="toc-importing-the-shapefile" class="nav-link" data-scroll-target="#importing-the-shapefile">5.2.1 Importing the shapefile</a></li>
  <li><a href="#removing-the-unwanted-variables" id="toc-removing-the-unwanted-variables" class="nav-link" data-scroll-target="#removing-the-unwanted-variables">5.2.2 Removing the unwanted variables</a></li>
  <li><a href="#checking-the-name-of-the-provinces" id="toc-checking-the-name-of-the-provinces" class="nav-link" data-scroll-target="#checking-the-name-of-the-provinces">5.2.3 Checking the name of the provinces</a></li>
  <li><a href="#adjusting-the-naming-of-provinces-in-province-sf-object" id="toc-adjusting-the-naming-of-provinces-in-province-sf-object" class="nav-link" data-scroll-target="#adjusting-the-naming-of-provinces-in-province-sf-object">5.2.3.1 Adjusting the naming of provinces in <em>province</em> sf object</a></li>
  <li><a href="#performing-relational-join" id="toc-performing-relational-join" class="nav-link" data-scroll-target="#performing-relational-join">5.3 Performing relational join</a></li>
  <li><a href="#relational-join-with-tourism_cleaned-data-frame" id="toc-relational-join-with-tourism_cleaned-data-frame" class="nav-link" data-scroll-target="#relational-join-with-tourism_cleaned-data-frame">5.3.1 Relational join with <em>tourism_cleaned</em> data frame</a></li>
  <li><a href="#saving-as-a-new-rds-file-3" id="toc-saving-as-a-new-rds-file-3" class="nav-link" data-scroll-target="#saving-as-a-new-rds-file-3">5.3.1.1 Saving as a new rds file</a></li>
  <li><a href="#relational-join-with-tourism_cleaned_spat-data-frame" id="toc-relational-join-with-tourism_cleaned_spat-data-frame" class="nav-link" data-scroll-target="#relational-join-with-tourism_cleaned_spat-data-frame">5.3.2 Relational join with <em>tourism_cleaned_spat</em> data frame</a></li>
  <li><a href="#saving-as-a-new-rds-file-4" id="toc-saving-as-a-new-rds-file-4" class="nav-link" data-scroll-target="#saving-as-a-new-rds-file-4">5.3.2.1 Saving as a new rds file</a></li>
  <li><a href="#relational-join-with-tourism_cleaned_temp-data-frame" id="toc-relational-join-with-tourism_cleaned_temp-data-frame" class="nav-link" data-scroll-target="#relational-join-with-tourism_cleaned_temp-data-frame">5.3.3 Relational join with <em>tourism_cleaned_temp</em> data frame</a></li>
  <li><a href="#saving-as-a-new-rds-file-5" id="toc-saving-as-a-new-rds-file-5" class="nav-link" data-scroll-target="#saving-as-a-new-rds-file-5">5.3.3.1 Saving as a new rds file</a></li>
  <li><a href="#creating-a-time-series-cube" id="toc-creating-a-time-series-cube" class="nav-link" data-scroll-target="#creating-a-time-series-cube">5.4 Creating a time series cube</a></li>
  <li><a href="#verifying-space-time-cube-object" id="toc-verifying-space-time-cube-object" class="nav-link" data-scroll-target="#verifying-space-time-cube-object">5.4.1 Verifying space-time cube object</a></li>
  <li><a href="#saving-as-a-new-rds-file-6" id="toc-saving-as-a-new-rds-file-6" class="nav-link" data-scroll-target="#saving-as-a-new-rds-file-6">5.4.2 Saving as a new rds file</a></li>
  </ul></li>
  <li><a href="#key-indicators-of-the-tourism-economy-of-thailand" id="toc-key-indicators-of-the-tourism-economy-of-thailand" class="nav-link" data-scroll-target="#key-indicators-of-the-tourism-economy-of-thailand">6. Key Indicators of the Tourism Economy of Thailand</a>
  <ul class="collapse">
  <li><a href="#visualising-indicators-of-tourism-economy" id="toc-visualising-indicators-of-tourism-economy" class="nav-link" data-scroll-target="#visualising-indicators-of-tourism-economy">6.1 Visualising Indicators of Tourism Economy</a></li>
  </ul></li>
  <li><a href="#generating-centroids" id="toc-generating-centroids" class="nav-link" data-scroll-target="#generating-centroids">7. Generating centroids</a>
  <ul class="collapse">
  <li><a href="#saving-as-a-new-rds-file-7" id="toc-saving-as-a-new-rds-file-7" class="nav-link" data-scroll-target="#saving-as-a-new-rds-file-7">7.1 Saving as a new rds file</a></li>
  <li><a href="#visualising-the-centroids" id="toc-visualising-the-centroids" class="nav-link" data-scroll-target="#visualising-the-centroids">7.2 Visualising the centroids</a></li>
  </ul></li>
  <li><a href="#computing-distance-based-spatial-weights" id="toc-computing-distance-based-spatial-weights" class="nav-link" data-scroll-target="#computing-distance-based-spatial-weights">8. Computing Distance-based Spatial Weights</a>
  <ul class="collapse">
  <li><a href="#computing-global-morans-i" id="toc-computing-global-morans-i" class="nav-link" data-scroll-target="#computing-global-morans-i">7.2 Computing Global Moran’s I</a></li>
  <li><a href="#determining-whether-key-indicators-are-independent-of-space" id="toc-determining-whether-key-indicators-are-independent-of-space" class="nav-link" data-scroll-target="#determining-whether-key-indicators-are-independent-of-space">7.2.1 Determining whether key indicators are independent of space</a></li>
  <li><a href="#total-revenue-1" id="toc-total-revenue-1" class="nav-link" data-scroll-target="#total-revenue-1">7.2.1.1 Total Revenue</a></li>
  <li><a href="#revenue-generated-by-foreign-tourists" id="toc-revenue-generated-by-foreign-tourists" class="nav-link" data-scroll-target="#revenue-generated-by-foreign-tourists">7.2.1.2 Revenue generated by foreign tourists</a></li>
  <li><a href="#revenue-generated-by-thai-tourists" id="toc-revenue-generated-by-thai-tourists" class="nav-link" data-scroll-target="#revenue-generated-by-thai-tourists">7.2.1.3 Revenue generated by Thai tourists</a></li>
  <li><a href="#tourist-numbers" id="toc-tourist-numbers" class="nav-link" data-scroll-target="#tourist-numbers">7.2.1.4 Tourist Numbers</a></li>
  <li><a href="#total-number-of-tourists" id="toc-total-number-of-tourists" class="nav-link" data-scroll-target="#total-number-of-tourists">7.2.1.5 Total number of tourists</a></li>
  <li><a href="#number-of-foreign-tourists-1" id="toc-number-of-foreign-tourists-1" class="nav-link" data-scroll-target="#number-of-foreign-tourists-1">7.2.1.6 Number of foreign tourists</a></li>
  <li><a href="#number-of-thai-tourists" id="toc-number-of-thai-tourists" class="nav-link" data-scroll-target="#number-of-thai-tourists">7.2.1.7 Number of Thai tourists</a></li>
  <li><a href="#occupancy-rate" id="toc-occupancy-rate" class="nav-link" data-scroll-target="#occupancy-rate">7.2.1.8 Occupancy Rate</a></li>
  <li><a href="#determining-whether-key-indicators-are-independent-of-space-and-time" id="toc-determining-whether-key-indicators-are-independent-of-space-and-time" class="nav-link" data-scroll-target="#determining-whether-key-indicators-are-independent-of-space-and-time">7.2.2 Determining whether key indicators are independent of space and time</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kock Si Min </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 2, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 7, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="take-home-exercise-2-discovering-impacts-of-covid-19-on-thailand-tourism-economy-at-the-province-level-using-spatial-and-spatio-temporal-statistics" class="level1">
<h1>Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics</h1>
<section id="setting-the-scene" class="level2">
<h2 class="anchored" data-anchor-id="setting-the-scene">1. Setting the Scene</h2>
<p>Tourism is one of Thailand’s largest industries, accounting for ~20% of the gross domestic product (GDP). In 2019, Thailand earned US$90 billion from domestic and international tourism, but the COVID-19 pandemic caused revenues to crash to US$24 billion in 2020.</p>
<p>The figure below shows the total revenue receipt from tourism sector between Jan 2019 to Feb 2023, and indicates that the revenue from tourism industry has been gradually recovering since Sep 2021.</p>
<p><img src="images/clipboard-378385426.png" class="img-fluid" width="460"></p>
<p>However, it is important to note that the tourism economy of Thailand is not evenly distributed. The figure below reveals that the tourism economy of Thailand in 2019 was mainly focused on five provinces, namely Bangkok, Phuket, Chon Buri, Krabi and Chiang Mai.</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">2. Objectives</h2>
<p>The objectives of this take-home exercise will be to discover:</p>
<ul>
<li><p>if the key indicators of tourism economy of Thailand are independent from space and space and time.</p></li>
<li><p>If the tourism economy is indeed spatial and spatio-temporal dependent, and if so, where the clusters, outliers and emerging hot spot/cold spot areas are.</p></li>
</ul>
</section>
<section id="the-task" class="level2">
<h2 class="anchored" data-anchor-id="the-task">3. The Task</h2>
<p>The specific tasks of this take-home exercise are as follows:</p>
<ul>
<li><p>Using appropriate function of <strong>sf</strong> and <strong>tidyverse</strong>, prepare the following geospatial data layer:</p>
<ul>
<li><p>a study area layer in sf polygon features. It must be at <a href="https://en.wikipedia.org/wiki/Provinces_of_Thailand">province level</a> (including Bangkok) of Thailand.</p></li>
<li><p>a tourism economy indicators layer within the study area in sf polygon features.</p></li>
<li><p>a derived tourism economy indicator layer in <a href="https://sfdep.josiahparry.com/articles/spacetime-s3"><strong>spacetime s3 class of sfdep</strong></a>. Keep the time series at <strong>month and year levels</strong>.</p></li>
</ul></li>
<li><p>Using the extracted data, perform global spatial autocorrelation analysis using <a href="https://is415-gaa-tskam.netlify.app/in-class_ex/in-class_ex05/in-class_ex05-glsa">sfdep methods</a>.</p></li>
<li><p>Using the extracted data, perform local spatial autocorrelation analysis using <a href="https://r4gdsa.netlify.app/chap10.html">sfdep methods</a>.</p></li>
<li><p>Using the extracted data, perform emerging hotspot analysis using <a href="https://is415-gaa-tskam.netlify.app/in-class_ex/in-class_ex05/in-class_ex05-ehsa">sfdep methods</a>.</p></li>
<li><p>Describe the spatial patterns revealed by the analysis above.</p></li>
</ul>
</section>
<section id="installing-and-loading-the-necessary-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="installing-and-loading-the-necessary-r-packages">4. Installing and Loading the necessary R packages</h2>
<p>We use the following code chunk to install and load the necessary R packages for our analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, sfdep, tmap, tidyverse, knitr, plotly, Kendall, VIM, naniar, DT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">5. The Data</h2>
<p>Two data sets shall be used:</p>
<ul>
<li><p><a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics">Thailand Domestic Tourism Statistics</a> at Kaggle - <strong>version 2</strong> of the data set will be used.</p></li>
<li><p><a href="https://data.humdata.org/dataset/cod-ab-tha?">Thailand - Subnational Administrative Boundaries</a> at HDX - the province boundary data set will be used.</p></li>
</ul>
<section id="thailand-domestic-tourism-statistics" class="level3">
<h3 class="anchored" data-anchor-id="thailand-domestic-tourism-statistics">5.1 Thailand Domestic Tourism Statistics</h3>
</section>
<section id="importing-the-csv-file" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-csv-file">5.1.1 Importing the csv file</h3>
<p>The code chunk below uses <a href="https://readr.tidyverse.org/reference/read_delim.html"><code>read_csv()</code></a>&nbsp;of readr package to load the Thailand Domestic Tourism Statistics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/rawdata/thailand_domestic_tourism_2019_2023_ver2.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <em>thai_tourism</em> data has 30,800 rows and 7 variables, namely <em>date, province_thai, province_eng, region_thai, region_eng, variable</em> and <em>value.</em></p>
</section>
<section id="cleaning-the-data" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-the-data">5.1.2 Cleaning the data</h3>
</section>
<section id="dropping-unwanted-variables" class="level3">
<h3 class="anchored" data-anchor-id="dropping-unwanted-variables">5.1.2.1 Dropping unwanted variables</h3>
<p>We will drop the columns <em>province_thai</em> and <em>region_thai</em> as these variables are in the Thai language which we do not understand and hence will not be helpful for our analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism[,<span class="sc">!</span><span class="fu">names</span>(tourism) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"province_thai"</span>,<span class="st">"region_thai"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-presence-of-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="determine-the-presence-of-missing-data">5.1.2.2 Determine the presence of missing data</h3>
<p>We determine the presence of missing values using the <em>vis_miss()</em> function of the <a href="https://cran.r-project.org/web/packages/naniar/vignettes/getting-started-w-naniar.html">naniar</a> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(tourism)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the output above, we note that there are no missing data.</p>
</section>
<section id="creating-new-year-month-and-day-variables" class="level3">
<h3 class="anchored" data-anchor-id="creating-new-year-month-and-day-variables">5.1.2.3 Creating new year, month and day variables</h3>
<p>From the code chunk below, we note that the <em>date</em> variable in <em>tourism</em> data frame is in the Date vector format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(tourism<span class="sc">$</span>date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Date"</code></pre>
</div>
</div>
<p>We form new variables <em>year</em> and <em>month</em> using the lubridate package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_month =</span> <span class="fu">ymd</span>(date),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">month</span>(date,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">abbr =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">.before =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-distribution-of-provinces-and-corresponding-regions" class="level3">
<h3 class="anchored" data-anchor-id="determine-the-distribution-of-provinces-and-corresponding-regions">5.1.2.4 Determine the distribution of provinces and corresponding regions</h3>
<p>We first study the distribution of regions in the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tourism, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(region_eng, region_eng, <span class="at">.fun =</span> length))) <span class="sc">+</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of domestic tourism statistics across regions"</span>, <span class="at">x =</span> <span class="st">"Regions"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the output above, we note that there 5 different types of regions represented, notably the western region is not represented in the data.</p>
<p>We take a more detailed look by determining the unique provinces represented in the data and their corresponding regions. This step aims to check for two things:</p>
<ul>
<li><p>whether there are any duplicate data entries i.e.&nbsp;entries that are meant to represent the same province but have spelling errors.</p></li>
<li><p>whether the regions for the provinces are accurately indicated</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tourism_unique <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng,region_eng) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(region_eng,province_eng)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>tourism_unique</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 77 × 2
   province_eng             region_eng
   &lt;chr&gt;                    &lt;chr&gt;     
 1 Ang Thong                central   
 2 Bangkok                  central   
 3 Chainat                  central   
 4 Kanchanaburi             central   
 5 Lopburi                  central   
 6 Nakhon Pathom            central   
 7 Nonthaburi               central   
 8 Pathum Thani             central   
 9 Phetchaburi              central   
10 Phra Nakhon Si Ayutthaya central   
# ℹ 67 more rows</code></pre>
</div>
</div>
<p>From the output above, we note that all 77 Thailand provinces are represented in the data, and that there are no spelling errors/misrepresented provinces.</p>
<p>However, with reference to the <a href="https://en.wikipedia.org/wiki/Provinces_of_Thailand">source on provinces in Thailand</a>, we note a few mistakes in the regions indicated for the provinces.</p>
<ul>
<li><p>Kanchanaburi, Phetchaburi, Prachuap Khiri Khan and Ratchaburi are stated as being in the central region but actually reside in the west region</p></li>
<li><p>Nakhon Nayok is stated as being in the east region but actually resides in the central region</p></li>
<li><p>The <em>east_northeast</em> region can actually be renamed as <em>northeast</em> region for clarity and consistency with how detailed the other provinces are labelled</p></li>
<li><p>Kamphaeng Phet, Nakhon Sawan, Phetchabun, Phichit, Phitsanulok, Sukhothai and Uthai Thani are stated as being in the north region but actually reside in central region</p></li>
<li><p>Tak is stated as being in the north region but actually resides in the west region</p></li>
<li><p>Sisaket is stated as being in the south region but actually resides in the northeast region</p></li>
</ul>
</section>
<section id="correcting-the-erroneous-regions-of-provinces" class="level3">
<h3 class="anchored" data-anchor-id="correcting-the-erroneous-regions-of-provinces">5.1.2.4.1 Correcting the erroneous regions of provinces</h3>
<p>We use the code chunk below to rename the “east_northeast” region to just “northeast” and correct the erroneous regions of the provinces mentioned above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region_eng =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    region_eng <span class="sc">==</span> <span class="st">"east_northeast"</span> <span class="sc">~</span> <span class="st">"northeast"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Kanchanaburi"</span>, <span class="st">"Phetchaburi"</span>, <span class="st">"Prachuap Khiri Khan"</span>, <span class="st">"Ratchaburi"</span>, <span class="st">"Tak"</span>) <span class="sc">~</span> <span class="st">"west"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nakhon Nayok"</span>,<span class="st">"Kamphaeng Phet"</span>,<span class="st">"Nakhon Sawan"</span>,<span class="st">"Phetchabun"</span>,<span class="st">"Phichit"</span>,<span class="st">"Phitsanulok"</span>,<span class="st">"Sukhothai"</span>,<span class="st">"Uthai Thani"</span>) <span class="sc">~</span> <span class="st">"central"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"Sisaket"</span> <span class="sc">~</span> <span class="st">"northeast"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> region_eng</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We check by generating the data table of provinces and their corresponding regions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tourism_unique <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng,region_eng) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(region_eng,province_eng)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(tourism_unique)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-527aeafcf967bd208b57" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-527aeafcf967bd208b57">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77"],["Ang Thong","Bangkok","Chainat","Kamphaeng Phet","Lopburi","Nakhon Nayok","Nakhon Pathom","Nakhon Sawan","Nonthaburi","Pathum Thani","Phetchabun","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Sing Buri","Sukhothai","Suphan Buri","Uthai Thani","Chachoengsao","Chanthaburi","Chonburi","Prachinburi","Rayong","Sa Kaeo","Trat","Chiang Mai","Chiang Rai","Lampang","Lamphun","Mae Hong Son","Nan","Phayao","Phrae","Uttaradit","Amnat Charoen","Bueng Kan","Buriram","Chaiyaphum","Kalasin","Khon Kaen","Loei","Maha Sarakham","Mukdahan","Nakhon Phanom","Nakhon Ratchasima","Nong Bua Lamphu","Nong Khai","Roi Et","Sakon Nakhon","Sisaket","Surin","Ubon Ratchathani","Udon Thani","Yasothon","Chumphon","Krabi","Nakhon Si Thammarat","Narathiwat","Pattani","Phang Nga","Phatthalung","Phuket","Ranong","Satun","Songkhla","Surat Thani","Trang","Yala","Kanchanaburi","Phetchaburi","Prachuap Khiri Khan","Ratchaburi","Tak"],["central","central","central","central","central","central","central","central","central","central","central","central","central","central","central","central","central","central","central","central","central","central","east","east","east","east","east","east","east","north","north","north","north","north","north","north","north","north","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","northeast","south","south","south","south","south","south","south","south","south","south","south","south","south","south","west","west","west","west","west"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province_eng<\/th>\n      <th>region_eng<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"province_eng","targets":1},{"name":"region_eng","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Re-plotting the distribution of domestic tourism statistics across the regions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tourism, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(region_eng, region_eng, <span class="at">.fun =</span> length))) <span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of domestic tourism statistics across regions"</span>, <span class="at">x =</span> <span class="st">"Regions"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We note that most of the domestic tourism statistics come from the central region, followed by northeast, south, north, east and finally the west region.</p>
</section>
<section id="determine-the-distribution-of-variables-and-corresponding-values" class="level3">
<h3 class="anchored" data-anchor-id="determine-the-distribution-of-variables-and-corresponding-values">5.1.2.5 Determine the distribution of variables and corresponding values</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tourism, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(variable, variable, <span class="at">.fun =</span> length))) <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Variable"</span>, <span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We note that there are 8 different types of variables:</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th>S/N</th>
<th>Variable</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>1</strong></td>
<td>no_tourist_all</td>
<td>The total number of domestic tourists who visited the province</td>
</tr>
<tr class="even">
<td><strong>2</strong></td>
<td>no_tourist_thai</td>
<td>The number of Thai tourists who visited the province</td>
</tr>
<tr class="odd">
<td><strong>3</strong></td>
<td>no_tourist_foreign</td>
<td>The number of foreign tourists who visited the province</td>
</tr>
<tr class="even">
<td><strong>4</strong></td>
<td>no_tourist_stay</td>
<td>The total number of tourists who stay overnight</td>
</tr>
<tr class="odd">
<td><strong>5</strong></td>
<td>ratio_tourist_stay</td>
<td>Ratio of tourists that stay overnight</td>
</tr>
<tr class="even">
<td><strong>6</strong></td>
<td>revenue_all</td>
<td>The revenue generated by the tourism industry in the province, in Thai Baht</td>
</tr>
<tr class="odd">
<td><strong>7</strong></td>
<td>revenue_foreign</td>
<td>The revenue generated by foreign tourists in the province, in Thai Baht</td>
</tr>
<tr class="even">
<td><strong>8</strong></td>
<td>revenue_thai</td>
<td>The revenue generated by Thai tourists in the province, in Thai Baht</td>
</tr>
</tbody>
</table>
</section>
<section id="pivot_wider-to-expand-variables-as-individual-columns" class="level3">
<h3 class="anchored" data-anchor-id="pivot_wider-to-expand-variables-as-individual-columns">5.1.2.5.1 pivot_wider() to expand variables as individual columns</h3>
<p>We utilise the <em>pivot_wider()</em> function to separate the different variable types as individual columns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tourism_wider <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-the-revenue-figures" class="level3">
<h3 class="anchored" data-anchor-id="checking-the-revenue-figures">5.1.2.5.2 Checking the revenue figures</h3>
<p>Based on the definition of the different variable types, we note that “revenue_all” should equal to the sum of “revenue_foreign” and “revenue_thai”. We check through the data using the code chunk below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>revenue_numbers <span class="ot">&lt;-</span> tourism_wider <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng,year_month) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sum_revenue =</span> <span class="fu">sum</span>(revenue_foreign, revenue_thai, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">revenue_all =</span> <span class="fu">sum</span>(revenue_all,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_rev_equal =</span> sum_revenue <span class="sc">==</span> revenue_all)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>revenue_numbers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,850 × 5
   province_eng  year_month sum_revenue revenue_all is_rev_equal
   &lt;chr&gt;         &lt;date&gt;           &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt;       
 1 Amnat Charoen 2019-01-01    34510000    34510000 TRUE        
 2 Amnat Charoen 2019-02-01    32290000    32290000 TRUE        
 3 Amnat Charoen 2019-03-01    39070000    39070000 TRUE        
 4 Amnat Charoen 2019-04-01    32040000    32040000 TRUE        
 5 Amnat Charoen 2019-05-01    30110000    30110000 TRUE        
 6 Amnat Charoen 2019-06-01    26630000    26630000 TRUE        
 7 Amnat Charoen 2019-07-01    21680000    21680000 TRUE        
 8 Amnat Charoen 2019-08-01    17700000    17700000 TRUE        
 9 Amnat Charoen 2019-09-01    19500000    19500000 TRUE        
10 Amnat Charoen 2019-10-01    61440000    61440000 TRUE        
# ℹ 3,840 more rows</code></pre>
</div>
</div>
<p>We note from the output below that the data entries for revenue match up:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>revenue_numbers <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>is_rev_equal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 5
# ℹ 5 variables: province_eng &lt;chr&gt;, year_month &lt;date&gt;, sum_revenue &lt;dbl&gt;,
#   revenue_all &lt;dbl&gt;, is_rev_equal &lt;lgl&gt;</code></pre>
</div>
</div>
</section>
<section id="checking-the-tourist-numbers" class="level3">
<h3 class="anchored" data-anchor-id="checking-the-tourist-numbers">5.1.2.5.3 Checking the tourist numbers</h3>
<p>Similarly, based on the definition of the different variable types, we note that “no_tourist_all” should equal to the sum of “no_tourist_foreign” and “no_tourist_thai”. We check through the data using the code chunk below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tourism_numbers <span class="ot">&lt;-</span> tourism_wider <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng,year_month) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sum_tourists =</span> <span class="fu">sum</span>(no_tourist_foreign, no_tourist_thai, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">tourists_all =</span> <span class="fu">sum</span>(no_tourist_all,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_touristno_equal =</span> sum_tourists <span class="sc">==</span> tourists_all)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>tourism_numbers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,850 × 5
   province_eng  year_month sum_tourists tourists_all is_touristno_equal
   &lt;chr&gt;         &lt;date&gt;            &lt;dbl&gt;        &lt;dbl&gt; &lt;lgl&gt;             
 1 Amnat Charoen 2019-01-01        21790        21790 TRUE              
 2 Amnat Charoen 2019-02-01        20377        20377 TRUE              
 3 Amnat Charoen 2019-03-01        24786        24786 TRUE              
 4 Amnat Charoen 2019-04-01        23792        23792 TRUE              
 5 Amnat Charoen 2019-05-01        22436        22436 TRUE              
 6 Amnat Charoen 2019-06-01        19714        19714 TRUE              
 7 Amnat Charoen 2019-07-01        20517        20517 TRUE              
 8 Amnat Charoen 2019-08-01        16708        16708 TRUE              
 9 Amnat Charoen 2019-09-01        18453        18453 TRUE              
10 Amnat Charoen 2019-10-01        39242        39242 TRUE              
# ℹ 3,840 more rows</code></pre>
</div>
</div>
<p>We note from the output below that the data entries for tourist numbers match up:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tourism_numbers <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>is_touristno_equal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 5
# ℹ 5 variables: province_eng &lt;chr&gt;, year_month &lt;date&gt;, sum_tourists &lt;dbl&gt;,
#   tourists_all &lt;dbl&gt;, is_touristno_equal &lt;lgl&gt;</code></pre>
</div>
</div>
</section>
<section id="checking-the-distribution-of-values-of-each-variable" class="level3">
<h3 class="anchored" data-anchor-id="checking-the-distribution-of-values-of-each-variable">5.1.2.5.4 Checking the distribution of values of each variable</h3>
<ul>
<li>Revenue</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>selected_revenue <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"revenue_all"</span>, <span class="st">"revenue_thai"</span>, <span class="st">"revenue_foreign"</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> selected_revenue <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">min</span>(value),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q1 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.25</span>),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> <span class="fu">median</span>(value),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q3 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.75</span>),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">max</span>(value)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(selected_revenue, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> variable, </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> Max <span class="sc">+</span> <span class="dv">1000</span>, </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Min:"</span>, Min,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\n</span><span class="st">Q1:"</span>, Q1, </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\n</span><span class="st">Median:"</span>, Median, </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\n</span><span class="st">Q3:"</span>, Q3, </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\n</span><span class="st">Max:"</span>, Max)),</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.75</span>), </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplots of Different Revenue Types"</span>, <span class="at">x =</span> <span class="st">"Revenue Type"</span>, <span class="at">y =</span> <span class="st">"Revenue"</span>)<span class="sc">+</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">12e+10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the boxplots above, we note that the minimum value for “revenue_foreign” is -$4250, this indicate that there could have been errors in data entry.</p>
<ul>
<li>Tourist numbers</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>selected_tourists <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"no_tourist_all"</span>,<span class="st">"no_tourist_thai"</span>, <span class="st">"no_tourist_foreign"</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> selected_tourists <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">min</span>(value),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q1 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.25</span>),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> <span class="fu">median</span>(value),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q3 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.75</span>),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">max</span>(value)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(selected_tourists, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> variable, </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> Max <span class="sc">+</span> <span class="dv">100000</span>, </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Min:"</span>, Min,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\n</span><span class="st">Q1:"</span>, Q1, </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\n</span><span class="st">Median:"</span>, Median, </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\n</span><span class="st">Q3:"</span>, Q3, </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\n</span><span class="st">Max:"</span>, Max)),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.75</span>), </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplots of Different Tourist Numbers"</span>, <span class="at">x =</span> <span class="st">"Tourist Type"</span>, <span class="at">y =</span> <span class="st">"Number of Tourists"</span>)<span class="sc">+</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">8e+6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Occupancy</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> tourism_wider <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">min</span>(no_tourist_stay),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q1 =</span> <span class="fu">quantile</span>(no_tourist_stay, <span class="fl">0.25</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> <span class="fu">median</span>(no_tourist_stay),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q3 =</span> <span class="fu">quantile</span>(no_tourist_stay, <span class="fl">0.75</span>),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">max</span>(no_tourist_stay)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tourism_wider, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> no_tourist_stay)) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> Max <span class="sc">+</span> <span class="dv">100000</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Min:"</span>, Min,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">"</span><span class="sc">\n</span><span class="st">Q1:"</span>, Q1,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">"</span><span class="sc">\n</span><span class="st">Median:"</span>, Median,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">"</span><span class="sc">\n</span><span class="st">Q3:"</span>, Q3,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">"</span><span class="sc">\n</span><span class="st">Max:"</span>, Max)),</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Number of Hotel Rooms Occupied"</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Occupied Hotel Rooms"</span>) <span class="sc">+</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4e+6</span>))<span class="sc">+</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="removing-data-with-negative-revenue_foreign-values" class="level3">
<h3 class="anchored" data-anchor-id="removing-data-with-negative-revenue_foreign-values">5.1.2.5.5 Removing data with negative “revenue_foreign” values</h3>
<p>Based on the results above, we clean the <em>tourism</em> data by removing rows with negative “revenue_foreign” values. We also remove the “date” variable to keep the data more tidy for further analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tourism &lt;- tourism_wider %&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(revenue_foreign &gt;= 0) %&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select(-date)</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism_wider <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After removing the data, we note that we have 3850 rows remaining.</p>
</section>
<section id="saving-as-a-new-rds-file" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-a-new-rds-file">5.1.2.6 Saving as a new rds file</h3>
<p>We save the cleaned data as a new rds file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>tourism_cleaned <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(tourism,<span class="st">"data/rds/tourism_cleaned.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>tourism_cleaned <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tourism_cleaned.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-a-data-frame-for-spatial-analysis" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-data-frame-for-spatial-analysis">5.1.3 Creating a data frame for spatial analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tourism_cleaned_spat <span class="ot">&lt;-</span> tourism_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng, region_eng) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_tot_revenue =</span> <span class="fu">median</span>(revenue_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_foreign_revenue =</span> <span class="fu">median</span>(revenue_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_thai_revenue =</span> <span class="fu">median</span>(revenue_thai, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_tot_tourist =</span> <span class="fu">median</span>(no_tourist_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_tot_foreign =</span> <span class="fu">median</span>(no_tourist_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_tot_thai =</span> <span class="fu">median</span>(no_tourist_thai, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_occup_rate =</span> <span class="fu">median</span>(ratio_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_occup_no =</span> <span class="fu">median</span>(no_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="saving-as-a-new-rds-file-1" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-a-new-rds-file-1">5.1.3.1 Saving as a new rds file</h3>
<p>We save the file as a new rds file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tourism_cleaned_spat <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(tourism_cleaned_spat,<span class="st">"data/rds/tourism_cleaned_spat.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tourism_cleaned_spat <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tourism_cleaned_spat.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-a-data-frame-for-temporal-analysis" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-data-frame-for-temporal-analysis">5.1.4 Creating a data frame for temporal analysis</h3>
<p>We plot the total revenue by year_month:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tourism_cleaned_summary <span class="ot">&lt;-</span> tourism_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_month =</span> <span class="fu">as.character</span>(year_month)) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year_month) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_revenue =</span> <span class="fu">sum</span>(revenue_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tourism_cleaned_summary, <span class="fu">aes</span>(<span class="at">x =</span> year_month, <span class="at">y =</span> total_revenue)) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Revenue by Year-Month"</span>, <span class="at">x =</span> <span class="st">"Year-Month"</span>, <span class="at">y =</span> <span class="st">"Total Revenue"</span>) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on the distribution of total revenue across the year_month variable, it can be seen that temporally, we can split the data into 3 time periods, namely:</p>
<ul>
<li><p>pre-COVID: Between Jan 2019 to Mar 2020</p></li>
<li><p>during COVID: Between Apr 2020 to Aug 2021</p></li>
<li><p>post-COVID: Between Sep 2021 to Feb 2023</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tourism_cleaned_temp <span class="ot">&lt;-</span> tourism_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_period =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    year_month <span class="sc">&gt;=</span> <span class="st">"2019-01-01"</span> <span class="sc">&amp;</span> year_month <span class="sc">&lt;=</span> <span class="st">"2020-03-01"</span> <span class="sc">~</span> <span class="st">"Pre-COVID"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    year_month <span class="sc">&gt;=</span> <span class="st">"2020-04-01"</span> <span class="sc">&amp;</span> year_month <span class="sc">&lt;=</span> <span class="st">"2021-08-01"</span> <span class="sc">~</span> <span class="st">"During-COVID"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    year_month <span class="sc">&gt;=</span> <span class="st">"2021-09-01"</span> <span class="sc">&amp;</span> year_month <span class="sc">&lt;=</span> <span class="st">"2023-02-01"</span> <span class="sc">~</span> <span class="st">"Post-COVID"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>tourism_cleaned_temp <span class="ot">&lt;-</span> tourism_cleaned_temp <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng,time_period) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_tot_revenue =</span> <span class="fu">median</span>(revenue_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_foreign_revenue =</span> <span class="fu">median</span>(revenue_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_thai_revenue =</span> <span class="fu">median</span>(revenue_thai, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_tot_tourist =</span> <span class="fu">median</span>(no_tourist_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_tot_foreign =</span> <span class="fu">median</span>(no_tourist_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_tot_thai =</span> <span class="fu">median</span>(no_tourist_thai, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_occup_rate =</span> <span class="fu">median</span>(ratio_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_occup_no =</span> <span class="fu">median</span>(no_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="saving-as-a-new-rds-file-2" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-a-new-rds-file-2">5.1.3.1 Saving as a new rds file</h3>
<p>We save the file as a new rds file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tourism_cleaned_temp <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(tourism_cleaned_temp,<span class="st">"data/rds/tourism_cleaned_temp.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>tourism_cleaned_temp <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tourism_cleaned_temp.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="thailand-subnational-administrative-boundaries" class="level3">
<h3 class="anchored" data-anchor-id="thailand-subnational-administrative-boundaries">5.2 Thailand Subnational Administrative Boundaries</h3>
</section>
<section id="importing-the-shapefile" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-shapefile">5.2.1 Importing the shapefile</h3>
<p>The code chunk below uses&nbsp;<code>st_read()</code>&nbsp;of&nbsp;<strong>sf</strong>&nbsp;package to import the Thailand Subnational Administrative Boundaries shapefile into R. There are a few different files representing different levels of administrative boundaries - level 0 (country), level 1 (province), level 2 (district) and level 3 (sub-district, tambon). As we are only interested in province level administrative boundaries, we will just load the file corresponding to level 1.</p>
<p>The imported shapefile will be a <strong>simple features</strong> <strong>object</strong> of <strong>sf</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>province <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/rawdata"</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">layer =</span> <span class="st">"tha_admbnda_adm1_rtsd_20220121"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We note that the simple features data has a multipolygon geometry and has 77 features and 16 fields. It is in WGS84 geographic coordinate system.</p>
</section>
<section id="removing-the-unwanted-variables" class="level3">
<h3 class="anchored" data-anchor-id="removing-the-unwanted-variables">5.2.2 Removing the unwanted variables</h3>
<p>Of the fields available, only “ADM1_EN” and “geometry” are essential hence the following code chunk keeps only these two variables in the simple features object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>province <span class="ot">&lt;-</span> province <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ADM1_EN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-the-name-of-the-provinces" class="level3">
<h3 class="anchored" data-anchor-id="checking-the-name-of-the-provinces">5.2.3 Checking the name of the provinces</h3>
<p>As we will be joining the <em>province</em> simple features object and the attribute data from <em>tourism_cleaned</em> using the province names (ADM1_EN in <em>province</em> simple features object and province_eng in <em>tourism_cleaned</em> dataframe), it is important to check through the naming of the provinces to ensure that they all match up.</p>
<p>We extract the unique province names from both <em>tourism_cleaned</em> and <em>province:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>unique_tour_prov <span class="ot">&lt;-</span> tourism_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(province_eng)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>unique_shp_prov <span class="ot">&lt;-</span> province <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(ADM1_EN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then combine via a full join and read through the list of province names for discrepancies:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>combined_prov <span class="ot">&lt;-</span> <span class="fu">full_join</span>(unique_shp_prov,unique_tour_prov,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ADM1_EN"</span><span class="ot">=</span><span class="st">"province_eng"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>combined_prov <span class="ot">&lt;-</span> combined_prov <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ADM1_EN)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>combined_prov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    ADM1_EN
1             Amnat Charoen
2                 Ang Thong
3                   Bangkok
4                 Bueng Kan
5                  Buri Ram
6                   Buriram
7              Chachoengsao
8                  Chai Nat
9                   Chainat
10               Chaiyaphum
11              Chanthaburi
12               Chiang Mai
13               Chiang Rai
14                Chon Buri
15                 Chonburi
16                 Chumphon
17                  Kalasin
18           Kamphaeng Phet
19             Kanchanaburi
20                Khon Kaen
21                    Krabi
22                  Lampang
23                  Lamphun
24                     Loei
25                 Lop Buri
26                  Lopburi
27             Mae Hong Son
28            Maha Sarakham
29                 Mukdahan
30             Nakhon Nayok
31            Nakhon Pathom
32            Nakhon Phanom
33        Nakhon Ratchasima
34             Nakhon Sawan
35      Nakhon Si Thammarat
36                      Nan
37               Narathiwat
38         Nong Bua Lam Phu
39          Nong Bua Lamphu
40                Nong Khai
41               Nonthaburi
42             Pathum Thani
43                  Pattani
44                Phang Nga
45                 Phangnga
46              Phatthalung
47                   Phayao
48               Phetchabun
49              Phetchaburi
50                  Phichit
51              Phitsanulok
52 Phra Nakhon Si Ayutthaya
53                    Phrae
54                   Phuket
55             Prachin Buri
56              Prachinburi
57      Prachuap Khiri Khan
58                   Ranong
59               Ratchaburi
60                   Rayong
61                   Roi Et
62                  Sa Kaeo
63             Sakon Nakhon
64             Samut Prakan
65             Samut Sakhon
66          Samut Songkhram
67                 Saraburi
68                    Satun
69                Si Sa Ket
70                Sing Buri
71                  Sisaket
72                 Songkhla
73                Sukhothai
74              Suphan Buri
75              Surat Thani
76                    Surin
77                      Tak
78                    Trang
79                     Trat
80         Ubon Ratchathani
81               Udon Thani
82              Uthai Thani
83                Uttaradit
84                     Yala
85                 Yasothon</code></pre>
</div>
</div>
<p>We note repeated entries for eight provinces which are spelt differently in the original <em>province</em> sf object vs <em>tourism_cleaned</em> dataframe:</p>
<ul>
<li><p>Buri Ram vs Buriram</p></li>
<li><p>Chai Nat vs Chainat</p></li>
<li><p>Chon Buri vs Chonburi</p></li>
<li><p>Lop Buri vs Lopburi</p></li>
<li><p>Nong Bua Lam Phu vs Nong Bua Lamphu</p></li>
<li><p>Phangnga vs Phang Nga</p></li>
<li><p>Prachin Buri vs Prachinburi</p></li>
<li><p>Si Sa Ket vs Sisaket</p></li>
</ul>
</section>
<section id="adjusting-the-naming-of-provinces-in-province-sf-object" class="level3">
<h3 class="anchored" data-anchor-id="adjusting-the-naming-of-provinces-in-province-sf-object">5.2.3.1 Adjusting the naming of provinces in <em>province</em> sf object</h3>
<p>We utilise the following code chunk to adjust the naming of the eight provinces to be aligned with the naming in the <em>tourism_cleaned</em> dataframe to faciliate relational join in subsequent analysis. We also rename “ADM1_EN” to “province_eng” to faciliate the creation of timeseries cube in subsequent analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>province <span class="ot">&lt;-</span> province <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ADM1_EN =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    ADM1_EN <span class="sc">==</span> <span class="st">"Buri Ram"</span> <span class="sc">~</span> <span class="st">"Buriram"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    ADM1_EN <span class="sc">==</span> <span class="st">"Chai Nat"</span> <span class="sc">~</span> <span class="st">"Chainat"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    ADM1_EN <span class="sc">==</span> <span class="st">"Chon Buri"</span> <span class="sc">~</span> <span class="st">"Chonburi"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    ADM1_EN <span class="sc">==</span> <span class="st">"Lop Buri"</span> <span class="sc">~</span> <span class="st">"Lopburi"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    ADM1_EN <span class="sc">==</span> <span class="st">"Nong Bua Lam Phu"</span> <span class="sc">~</span> <span class="st">"Nong Bua Lamphu"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    ADM1_EN <span class="sc">==</span> <span class="st">"Phangnga"</span> <span class="sc">~</span> <span class="st">"Phang Nga"</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    ADM1_EN <span class="sc">==</span> <span class="st">"Prachin Buri"</span> <span class="sc">~</span> <span class="st">"Prachinburi"</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    ADM1_EN <span class="sc">==</span> <span class="st">"Si Sa Ket"</span> <span class="sc">~</span> <span class="st">"Sisaket"</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> ADM1_EN)) <span class="sc">%&gt;%</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">province_eng =</span> ADM1_EN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We save this as new rds file to avoid reloading the original datafile above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>province <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(province,<span class="st">"data/rds/province.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>province <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/province.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="performing-relational-join" class="level3">
<h3 class="anchored" data-anchor-id="performing-relational-join">5.3 Performing relational join</h3>
</section>
<section id="relational-join-with-tourism_cleaned-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="relational-join-with-tourism_cleaned-data-frame">5.3.1 Relational join with <em>tourism_cleaned</em> data frame</h3>
<p>We then perform a left relational join to update the <em>province</em> sf object with the attribute fields of the <em>tourism_cleaned</em> data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>combined_prov_tourism <span class="ot">&lt;-</span> <span class="fu">left_join</span>(province,tourism_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(combined_prov_tourism)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,850
Columns: 14
$ province_eng       &lt;chr&gt; "Bangkok", "Bangkok", "Bangkok", "Bangkok", "Bangko…
$ year_month         &lt;date&gt; 2019-01-01, 2020-01-01, 2021-01-01, 2022-01-01, 20…
$ year               &lt;dbl&gt; 2019, 2020, 2021, 2022, 2023, 2019, 2020, 2021, 202…
$ month              &lt;ord&gt; Jan, Jan, Jan, Jan, Jan, Feb, Feb, Feb, Feb, Feb, M…
$ region_eng         &lt;chr&gt; "central", "central", "central", "central", "centra…
$ ratio_tourist_stay &lt;dbl&gt; 93.37, 89.36, 7.54, 26.34, 75.02, 89.19, 68.37, 9.9…
$ no_tourist_stay    &lt;dbl&gt; 3334971, 3213765, 354676, 1009583, 2440463, 3025538…
$ no_tourist_all     &lt;dbl&gt; 5959075, 6046765, 1681847, 2437497, 4872078, 521140…
$ no_tourist_thai    &lt;dbl&gt; 3534061, 3573040, 1632693, 2299906, 2749877, 291992…
$ no_tourist_foreign &lt;dbl&gt; 2425014, 2473725, 49154, 137591, 2122201, 2291482, …
$ revenue_all        &lt;dbl&gt; 81926490000, 88202890000, 9539730000, 11823610000, …
$ revenue_thai       &lt;dbl&gt; 29742580000, 31137650000, 8447450000, 9642600000, 1…
$ revenue_foreign    &lt;dbl&gt; 52183910000, 57065240000, 1092280000, 2181010000, 4…
$ geometry           &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((100.6139 13..., MULTIP…</code></pre>
</div>
</div>
<p>We note that the <em>combined_prov_tourism</em> data has the same number of rows, 3848 rows, as the original <em>tourism_cleaned</em> data frame indicating that the cleaning up of the different province spellings was done accurately.</p>
</section>
<section id="saving-as-a-new-rds-file-3" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-a-new-rds-file-3">5.3.1.1 Saving as a new rds file</h3>
<p>We save the combined file as a new rds file and load it into the R environment for further analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(combined_prov_tourism,<span class="st">"data/rds/combined_prov_tourism.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/combined_prov_tourism.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="relational-join-with-tourism_cleaned_spat-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="relational-join-with-tourism_cleaned_spat-data-frame">5.3.2 Relational join with <em>tourism_cleaned_spat</em> data frame</h3>
<p>We also perform a left relational join to update the <em>province</em> sf object with the attribute fields of the <em>tourism_cleaned_spat</em> data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>combined_tourism_spat <span class="ot">&lt;-</span> <span class="fu">left_join</span>(province,tourism_cleaned_spat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(combined_tourism_spat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 77
Columns: 11
$ province_eng           &lt;chr&gt; "Bangkok", "Samut Prakan", "Nonthaburi", "Pathu…
$ region_eng             &lt;chr&gt; "central", "central", "central", "central", "ce…
$ median_tot_revenue     &lt;dbl&gt; 16554390000, 228515000, 216067500, 135655000, 8…
$ median_foreign_revenue &lt;dbl&gt; 8025340000, 26780000, 4880000, 1740000, 1550500…
$ median_thai_revenue    &lt;dbl&gt; 11973495000, 194440000, 214815000, 129105000, 7…
$ median_tot_tourist     &lt;dbl&gt; 2681686.0, 149277.0, 161057.5, 100804.0, 557916…
$ median_tot_foreign     &lt;dbl&gt; 308839.5, 19441.5, 2029.0, 1166.5, 8347.5, 7.0,…
$ median_tot_thai        &lt;dbl&gt; 2309799.5, 127042.5, 157859.5, 98375.5, 495576.…
$ median_occup_rate      &lt;dbl&gt; 35.355, 28.300, 37.590, 25.980, 48.660, 28.995,…
$ median_occup_no        &lt;dbl&gt; 1151894.5, 47140.5, 54486.0, 23215.0, 68597.0, …
$ geometry               &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((100.6139 13..., MU…</code></pre>
</div>
</div>
</section>
<section id="saving-as-a-new-rds-file-4" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-a-new-rds-file-4">5.3.2.1 Saving as a new rds file</h3>
<p>We save the combined file as a new rds file and load it into the R environment for further analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>combined_data_spat <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(combined_tourism_spat,<span class="st">"data/rds/combined_data_spat.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>combined_data_spat <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/combined_data_spat.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="relational-join-with-tourism_cleaned_temp-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="relational-join-with-tourism_cleaned_temp-data-frame">5.3.3 Relational join with <em>tourism_cleaned_temp</em> data frame</h3>
<p>We also perform a left relational join to update the <em>province</em> sf object with the attribute fields of the <em>tourism_cleaned_temp</em> data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>combined_tourism_temp <span class="ot">&lt;-</span> <span class="fu">left_join</span>(province,tourism_cleaned_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(combined_tourism_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 231
Columns: 11
$ province_eng           &lt;chr&gt; "Bangkok", "Bangkok", "Bangkok", "Samut Prakan"…
$ time_period            &lt;chr&gt; "During-COVID", "Post-COVID", "Pre-COVID", "Dur…
$ median_tot_revenue     &lt;dbl&gt; 9539730000, 22927845000, 87753820000, 64680000,…
$ median_foreign_revenue &lt;dbl&gt; 1152230000, 11714170000, 54153040000, 50000, 46…
$ median_thai_revenue    &lt;dbl&gt; 8348660000, 11762345000, 29052570000, 64680000,…
$ median_tot_tourist     &lt;dbl&gt; 1115611.0, 2879758.0, 5620260.0, 51035.0, 16007…
$ median_tot_foreign     &lt;dbl&gt; 53676.0, 613626.0, 2087831.0, 61.0, 36441.0, 83…
$ median_tot_thai        &lt;dbl&gt; 1063854.0, 2363948.0, 3534061.0, 51035.0, 12833…
$ median_occup_rate      &lt;dbl&gt; 11.270, 41.065, 79.440, 7.740, 29.115, 57.790, …
$ median_occup_no        &lt;dbl&gt; 476161.0, 1246119.5, 3008999.0, 9972.0, 47503.5…
$ geometry               &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((100.6139 13..., MU…</code></pre>
</div>
</div>
</section>
<section id="saving-as-a-new-rds-file-5" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-a-new-rds-file-5">5.3.3.1 Saving as a new rds file</h3>
<p>We save the combined file as a new rds file and load it into the R environment for further analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>combined_data_temp <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(combined_tourism_temp,<span class="st">"data/rds/combined_data_temp.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>combined_data_temp <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/combined_data_temp.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-a-time-series-cube" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-time-series-cube">5.4 Creating a time series cube</h3>
<p>We use <a href="https://sfdep.josiahparry.com/articles/spacetime-s3.html">spacetime()</a>&nbsp;of sfdep to create a spatio-temporal cube:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>spt <span class="ot">&lt;-</span> <span class="fu">spacetime</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  tourism_cleaned,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  province,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">.loc_col =</span> <span class="st">"province_eng"</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">.time_col =</span> <span class="st">"year_month"</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="verifying-space-time-cube-object" class="level3">
<h3 class="anchored" data-anchor-id="verifying-space-time-cube-object">5.4.1 Verifying space-time cube object</h3>
<p>We utilise the following code chunk to verify if <em>spt</em> is indeed a space-time cube object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(spt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="saving-as-a-new-rds-file-6" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-a-new-rds-file-6">5.4.2 Saving as a new rds file</h3>
<p>We save <em>spt</em> as a new rds file and load it into the R environment for further analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>spt <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(spt,<span class="st">"data/rds/spt.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>spt <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/spt.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="key-indicators-of-the-tourism-economy-of-thailand" class="level2">
<h2 class="anchored" data-anchor-id="key-indicators-of-the-tourism-economy-of-thailand">6. Key Indicators of the Tourism Economy of Thailand</h2>
<p>From the above data, we note that there are several possible key indicators of the tourism economy of Thailand to analyse, namely: (i) Total revenue, (ii) Revenue generated from foreign tourists, (iii) Revenue generated from local/Thai tourists, (iv) Total number of tourists, (v) Number of foreign tourists, (vi) Number of local/Thai tourists and (vii) Rate of tourists who stay overnight. For our analysis, we will focus on the following indicators for reasons stated below:</p>
<p>(i) <strong>Total revenue:</strong> Revenue generated from both foreign and local tourists can indicate how well Thai’s tourism economy is performing.</p>
<p>(ii) <strong>Number of foreign tourists:</strong> Based on <a href="https://www.adb.org/sites/default/files/linked-documents/54177-001-sd-12.pdf">literature</a>, Thailand recorded a total THB1.9 trillion receipts from foreign tourists (65% of the sector’s receipts) or 11.5% of its GDP in 2019. The daily foreign tourist spending was around $192 per person, more than double of domestic tourists spending. The number of foreign tourists will hence be a strong indicator of how well the Thai tourism economy is performing i.e.&nbsp;the greater number of tourists, coupled with their higher propensity to spend, would be indicative of a booming tourism economy.</p>
<p>(iii) <strong>Rate of tourists who stay overnight:</strong> A higher rate of tourists who stay overnight can be indicative of how well the tourism economy is performing as tourists who stay for longer periods in Thailand are likely to incur more expenditure i.e.&nbsp;via spending on accommodation, more activities.</p>
<section id="visualising-indicators-of-tourism-economy" class="level3">
<h3 class="anchored" data-anchor-id="visualising-indicators-of-tourism-economy">6.1 Visualising Indicators of Tourism Economy</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Total Revenue</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Number of Foreign Tourists</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Rate of tourists who stay overnight</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(combined_data_spat)<span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"median_tot_revenue"</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>)<span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Distribution of Median Total Revenue (Quantile classification)"</span>,<span class="at">main.title.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="dv">1</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"province_eng"</span>,<span class="at">size =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(combined_data_spat)<span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"median_tot_foreign"</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>)<span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Distribution of Median Total Foreign Tourists (Quantile classification)"</span>,<span class="at">main.title.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="dv">1</span>,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"province_eng"</span>,<span class="at">size =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(combined_data_spat)<span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"median_occup_rate"</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>)<span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Distribution of Median Rate of Overnights Tourists (Quantile classification)"</span>,<span class="at">main.title.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="dv">1</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"province_eng"</span>,<span class="at">size =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="generating-centroids" class="level2">
<h2 class="anchored" data-anchor-id="generating-centroids">7. Generating centroids</h2>
<p>A connectivity graph takes a point and displays a line to each neighbouring point. As we are working with multipolygons, we will need to get points to make connectivity graphs. As such, we will need to create centroids for each province.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>centroids <span class="ot">&lt;-</span> combined_data_spat <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_centroid</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="saving-as-a-new-rds-file-7" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-a-new-rds-file-7">7.1 Saving as a new rds file</h3>
<p>We save <em>centroids</em> as a new rds file and load it into the R environment for further analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>centroids <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(centroids,<span class="st">"data/rds/centroids.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>centroids <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/centroids.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualising-the-centroids" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-centroids">7.2 Visualising the centroids</h3>
<p>We visualise where these centroids are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(province) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>()<span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>()<span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(centroids)<span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">title =</span> <span class="st">"Centroids"</span>) <span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"province_eng"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Centroids of Provinces"</span>, <span class="at">main.title.size =</span> <span class="fl">0.5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We note that none of the centroids generated are in the water and are all located within the regions of provinces.</p>
</section>
</section>
<section id="computing-distance-based-spatial-weights" class="level2">
<h2 class="anchored" data-anchor-id="computing-distance-based-spatial-weights">8. Computing Distance-based Spatial Weights</h2>
<section id="computing-global-morans-i" class="level3">
<h3 class="anchored" data-anchor-id="computing-global-morans-i">7.2 Computing Global Moran’s I</h3>
</section>
<section id="determining-whether-key-indicators-are-independent-of-space" class="level3">
<h3 class="anchored" data-anchor-id="determining-whether-key-indicators-are-independent-of-space">7.2.1 Determining whether key indicators are independent of space</h3>
</section>
<section id="total-revenue-1" class="level3">
<h3 class="anchored" data-anchor-id="total-revenue-1">7.2.1.1 Total Revenue</h3>
</section>
<section id="revenue-generated-by-foreign-tourists" class="level3">
<h3 class="anchored" data-anchor-id="revenue-generated-by-foreign-tourists">7.2.1.2 Revenue generated by foreign tourists</h3>
</section>
<section id="revenue-generated-by-thai-tourists" class="level3">
<h3 class="anchored" data-anchor-id="revenue-generated-by-thai-tourists">7.2.1.3 Revenue generated by Thai tourists</h3>
</section>
<section id="tourist-numbers" class="level3">
<h3 class="anchored" data-anchor-id="tourist-numbers">7.2.1.4 Tourist Numbers</h3>
</section>
<section id="total-number-of-tourists" class="level3">
<h3 class="anchored" data-anchor-id="total-number-of-tourists">7.2.1.5 Total number of tourists</h3>
</section>
<section id="number-of-foreign-tourists-1" class="level3">
<h3 class="anchored" data-anchor-id="number-of-foreign-tourists-1">7.2.1.6 Number of foreign tourists</h3>
</section>
<section id="number-of-thai-tourists" class="level3">
<h3 class="anchored" data-anchor-id="number-of-thai-tourists">7.2.1.7 Number of Thai tourists</h3>
</section>
<section id="occupancy-rate" class="level3">
<h3 class="anchored" data-anchor-id="occupancy-rate">7.2.1.8 Occupancy Rate</h3>
</section>
<section id="determining-whether-key-indicators-are-independent-of-space-and-time" class="level3">
<h3 class="anchored" data-anchor-id="determining-whether-key-indicators-are-independent-of-space-and-time">7.2.2 Determining whether key indicators are independent of space and time</h3>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>